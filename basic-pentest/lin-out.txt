
                            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
                    ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄
             ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄
         ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄
         ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄
         ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ 
         ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄
         ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄
         ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄
         ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄
         ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄
         ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄
         ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄
         ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ 
          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ 
         ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
          ▀▀▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀
               ▀▀▀▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▀▀
                     ▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀

    /---------------------------------------------------------------------------\
    |                             Do you like PEASS?                            |
    |---------------------------------------------------------------------------| 
    |         Become a Patreon    :     https://www.patreon.com/peass           |
    |         Follow on Twitter   :     @carlospolopm                           |
    |         Respect on HTB      :     SirBroccoli & makikvues                 |
    |---------------------------------------------------------------------------|
    |                                 Thank you!                                |
    \---------------------------------------------------------------------------/
          linpeas-ng by carlospolop

ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own computers and/or with the computer owner's permission.

Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
 LEGEND:
  RED/YELLOW: 95% a PE vector
  RED: You should take a look to it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMagenta: Your username

 Starting linpeas. Caching Writable Folders...

                                         ╔═══════════════════╗
═════════════════════════════════════════╣ Basic information ╠═════════════════════════════════════════
                                         ╚═══════════════════╝
OS: Linux version 4.10.0-28-generic (buildd@lgw01-12) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #32~16.04.2-Ubuntu SMP Thu Jul 20 10:19:48 UTC 2017
User & Groups: uid=33(www-data) gid=33(www-data) groups=33(www-data)
Hostname: vtcsec
Writable folder: /dev/shm
[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /bin/nc is available for network discover & port scanning (linpeas can discover hosts and scan ports, learn more with -h)


Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . uniq: write error: Broken pipe
uniq: write error: Broken pipe
DONE

                                        ╔════════════════════╗
════════════════════════════════════════╣ System Information ╠════════════════════════════════════════
                                        ╚════════════════════╝
╔══════════╣ Operative system
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits
Linux version 4.10.0-28-generic (buildd@lgw01-12) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #32~16.04.2-Ubuntu SMP Thu Jul 20 10:19:48 UTC 2017
Distributor ID:	Ubuntu
Description:	Ubuntu 16.04.3 LTS
Release:	16.04
Codename:	xenial

╔══════════╣ Sudo version
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version
Sudo version 1.8.16

╔══════════╣ USBCreator
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation

╔══════════╣ PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

╔══════════╣ Date & uptime
Thu Jan 20 05:59:24 EST 2022
 05:59:24 up  8:52,  0 users,  load average: 0.15, 0.13, 0.09

╔══════════╣ Environment
╚ Any private information inside environment variables?
HISTFILESIZE=0
SHLVL=1
OLDPWD=/var/tmp
APACHE_RUN_DIR=/var/run/apache2
APACHE_PID_FILE=/var/run/apache2/apache2.pid
_=./li.sh
TERM=xterm
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
APACHE_LOCK_DIR=/var/lock/apache2
LANG=C
HISTSIZE=0
APACHE_RUN_USER=www-data
APACHE_RUN_GROUP=www-data
APACHE_LOG_DIR=/var/log/apache2
PWD=/var/tmp/www
HISTFILE=/dev/null

╔══════════╣ Searching Signature verification failed in dmesg
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed
dmesg Not Found

╔══════════╣ Executing Linux Exploit Suggester
╚ https://github.com/mzet-/linux-exploit-suggester

Available information:

Kernel version: 4.10.0
Architecture: x86_64
Distribution: ubuntu
Distribution version: 16.04
Additional checks (CONFIG_*, sysctl entries, custom Bash commands): performed
Package listing: from current OS

Searching among:

78 kernel space exploits
48 user space exploits

Possible Exploits:

cat: write error: Broken pipe
cat: write error: Broken pipe
cat: write error: Broken pipe
cat: write error: Broken pipe
cat: write error: Broken pipe
cat: write error: Broken pipe
[+] [CVE-2021-3156] sudo Baron Samedit 2

   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
   Exposure: probable
   Tags: centos=6|7|8,[ ubuntu=14|16|17|18|19|20 ], debian=9|10
   Download URL: https://codeload.github.com/worawit/CVE-2021-3156/zip/main

[+] [CVE-2017-7308] af_packet

   Details: https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html
   Exposure: probable
   Tags: [ ubuntu=16.04 ]{kernel:4.8.0-(34|36|39|41|42|44|45)-generic}
   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-7308/poc.c
   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2017-7308/poc.c
   Comments: CAP_NET_RAW cap or CONFIG_USER_NS=y needed. Modified version at 'ext-url' adds support for additional kernels

[+] [CVE-2017-1000112] NETIF_F_UFO

   Details: http://www.openwall.com/lists/oss-security/2017/08/13/1
   Exposure: probable
   Tags: ubuntu=14.04{kernel:4.4.0-*},[ ubuntu=16.04 ]{kernel:4.8.0-*}
   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-1000112/poc.c
   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2017-1000112/poc.c
   Comments: CAP_NET_ADMIN cap or CONFIG_USER_NS=y needed. SMEP/KASLR bypass included. Modified version at 'ext-url' adds support for additional distros/kernels

[+] [CVE-2021-3156] sudo Baron Samedit

   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
   Exposure: less probable
   Tags: mint=19,ubuntu=18|20, debian=10
   Download URL: https://codeload.github.com/blasty/CVE-2021-3156/zip/main

[+] [CVE-2021-22555] Netfilter heap out-of-bounds write

   Details: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html
   Exposure: less probable
   Tags: ubuntu=20.04{kernel:5.8.0-*}
   Download URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c
   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c
   Comments: ip_tables kernel module must be loaded

[+] [CVE-2019-18634] sudo pwfeedback

   Details: https://dylankatz.com/Analysis-of-CVE-2019-18634/
   Exposure: less probable
   Tags: mint=19
   Download URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c
   Comments: sudo configuration requires pwfeedback to be enabled.

[+] [CVE-2019-15666] XFRM_UAF

   Details: https://duasynt.com/blog/ubuntu-centos-redhat-privesc
   Exposure: less probable
   Download URL: 
   Comments: CONFIG_USER_NS needs to be enabled; CONFIG_XFRM needs to be enabled

[+] [CVE-2018-1000001] RationalLove

   Details: https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/
   Exposure: less probable
   Tags: debian=9{libc6:2.24-11+deb9u1},ubuntu=16.04.3{libc6:2.23-0ubuntu9}
   Download URL: https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/RationalLove.c
   Comments: kernel.unprivileged_userns_clone=1 required

[+] [CVE-2017-1000366,CVE-2017-1000379] linux_ldso_hwcap_64

   Details: https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt
   Exposure: less probable
   Tags: debian=7.7|8.5|9.0,ubuntu=14.04.2|16.04.2|17.04,fedora=22|25,centos=7.3.1611
   Download URL: https://www.qualys.com/2017/06/19/stack-clash/linux_ldso_hwcap_64.c
   Comments: Uses "Stack Clash" technique, works against most SUID-root binaries

[+] [CVE-2017-1000253] PIE_stack_corruption

   Details: https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.txt
   Exposure: less probable
   Tags: RHEL=6,RHEL=7{kernel:3.10.0-514.21.2|3.10.0-514.26.1}
   Download URL: https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.c

[+]  [CVE-2017-16995] eBPF_verifier

   Details: https://ricklarabee.blogspot.com/2018/07/ebpf-and-analysis-of-get-rekt-linux.html
   Exposure: highly probable
   Tags: debian=9.0{kernel:4.9.0-3-amd64},fedora=25|26|27,ubuntu=14.04{kernel:4.4.0-89-generic},[ ubuntu=(16.04|17.04){kernel:4.(8|10).0-(19|28|45)-generic} ]
   Download URL: https://www.exploit-db.com/download/45010
   Comments: CONFIG_BPF_SYSCALL needs to be set && kernel.unprivileged_bpf_disabled != 1


╔══════════╣ Executing Linux Exploit Suggester 2
╚ https://github.com/jondonas/linux-exploit-suggester-2

  #############################
    Linux Exploit Suggester 2
  #############################

  Local Kernel: 4.10.0
  Searching 72 exploits...

  Possible Exploits
  [1] get_rekt
      CVE-2017-16695
      Source: http://www.exploit-db.com/exploits/45010


╔══════════╣ Protections
═╣ AppArmor enabled? .............. You do not have enough privilege to read the profile set.
apparmor module is loaded.
═╣ grsecurity present? ............ grsecurity Not Found
═╣ PaX bins present? .............. PaX Not Found
═╣ Execshield enabled? ............ Execshield Not Found
═╣ SELinux enabled? ............... sestatus Not Found
═╣ Is ASLR enabled? ............... Yes
═╣ Printer? ....................... No
═╣ Is this a virtual machine? ..... Yes (vmware)

                                             ╔═══════════╗
═════════════════════════════════════════════╣ Container ╠═════════════════════════════════════════════
                                             ╚═══════════╝
╔══════════╣ Container related tools present
╔══════════╣ Container details
═╣ Is this a container? ........... No
═╣ Any running containers? ........ No


                          ╔════════════════════════════════════════════════╗
══════════════════════════╣ Processes, Crons, Timers, Services and Sockets ╠══════════════════════════
                          ╚════════════════════════════════════════════════╝
╔══════════╣ Cleaned processes
╚ Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes
root         1  0.0  0.1 119664  5816 ?        Ss   Jan19   0:09 /lib/systemd/systemd --system --deserialize 23
root       326  0.0  0.0  32256  2856 ?        Ss   Jan19   0:01 /lib/systemd/systemd-journald
root       817  0.0  0.0  36076  3012 ?        Ss   Jan19   0:00 /usr/sbin/cron -f
message+   818  0.0  0.1  43820  4972 ?        Ss   Jan19   0:04 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation
  └─(Caps) 0x0000000020000000=cap_audit_write
root       819  0.0  0.2 337372 10208 ?        Ssl  Jan19   0:00 /usr/sbin/ModemManager
root       824  0.0  0.3 530092 15868 ?        Ssl  Jan19   0:01 /usr/sbin/NetworkManager --no-daemon[0m
nobody    1433  0.0  0.1  59936  4060 ?        S    Jan19   0:00  _ /usr/sbin/dnsmasq --no-resolv --keep-in-foreground --no-hosts --bind-interfaces --pid-file=/var/run/NetworkManager/dnsmasq.pid --listen-address=127.0.1.1 --cache-size=0 --conf-file=/dev/null --proxy-dnssec --enable-dbus=org.freedesktop.NetworkManager.dnsmasq --conf-dir=/etc/NetworkManager/dnsmasq.d
  └─(Caps) 0x0000000000003000=cap_net_admin,cap_net_raw
root      9050  0.0  0.0  16124  3644 ?        S    03:02   0:00  _ /sbin/dhclient -d -q -sf /usr/lib/NetworkManager/nm-dhcp-helper -pf /var/run/dhclient-ens33.pid -lf /var/lib/NetworkManager/dhclient-2610c1c3-e19c-31b3-b08c-e544db4790e5-ens33.lease -cf /var/lib/NetworkManager/dhclient-ens33.conf ens33
root       825  0.0  0.0  28660  3100 ?        Ss   Jan19   0:00 /lib/systemd/systemd-logind
syslog     829  0.0  0.0 256400  3252 ?        Ssl  Jan19   0:00 /usr/sbin/rsyslogd -n
root       831  0.0  0.0   4400   676 ?        Ss   Jan19   0:00 /usr/sbin/acpid
root       921  0.0  0.0  19584  2064 ?        Ss   Jan19   0:00 /usr/sbin/irqbalance --pid=/var/run/irqbalance.pid
root       945  0.0  0.1 350384  6072 ?        Ssl  Jan19   0:00 /usr/sbin/lightdm
root       976  0.0  1.0 321568 42040 tty7     Ssl+ Jan19   0:05  _ /usr/lib/xorg/Xorg -core :0 -seat seat0 -auth /var/run/lightdm/root/:0 -nolisten tcp vt7 -novtswitch
root      1000  0.0  0.1 226180  6264 ?        Sl   Jan19   0:00  _ lightdm --session-child 16 19
lightdm   1012  0.0  0.0   4508   756 ?        Ss   Jan19   0:00  |   _ /bin/sh /usr/lib/lightdm/lightdm-greeter-session /usr/sbin/unity-greeter
lightdm   1018  0.0  1.4 1019352 60208 ?       Sl   Jan19   0:06  |       _ /usr/sbin/unity-greeter
root      1417  0.0  0.1  82708  4940 ?        S    Jan19   0:00  _ lightdm --session-child 12 19
nobody     961  0.0  0.0  15908  2436 ?        Ss   Jan19   0:00 proftpd: (accepting connections)
lightdm   1003  0.0  0.1  45248  4580 ?        Ss   Jan19   0:00 /lib/systemd/systemd --user
lightdm   1004  0.0  0.0  63324  1964 ?        S    Jan19   0:00  _ (sd-pam)
lightdm   1017  0.0  0.0  43100  3476 ?        Ss   Jan19   0:00 /usr/bin/dbus-daemon --fork --print-pid 5 --print-address 7 --session
lightdm   1020  0.0  0.1 337984  5612 ?        Sl   Jan19   0:00 /usr/lib/at-spi2-core/at-spi-bus-launcher --launch-immediately
lightdm   1025  0.0  0.0  42768  3472 ?        S    Jan19   0:00  _ /usr/bin/dbus-daemon --config-file=/etc/at-spi2/accessibility.conf --nofork --print-address 3
lightdm   1040  0.0  0.1 206972  6436 ?        Sl   Jan19   0:00 /usr/lib/at-spi2-core/at-spi2-registryd --use-gnome-session
lightdm   1044  0.0  0.1 281488  6228 ?        Sl   Jan19   0:00 /usr/lib/gvfs/gvfsd
lightdm   1051  0.0  0.1 341328  4776 ?        Sl   Jan19   0:00 /usr/lib/gvfs/gvfsd-fuse /run/user/108/gvfs -f -o big_writes
lightdm   1062  0.0  0.1 178532  4696 ?        Sl   Jan19   0:00 /usr/lib/dconf/dconf-service
lightdm   1072  0.0  0.1  53028  4288 ?        S    Jan19   0:00 upstart --user --startup-event indicator-services-start
lightdm   1085  0.0  0.1 361448  7064 ?        Ssl  Jan19   0:00  _ /usr/lib/x86_64-linux-gnu/indicator-messages/indicator-messages-service
lightdm   1086  0.0  0.1 414172  4092 ?        Ssl  Jan19   0:00  _ /usr/lib/x86_64-linux-gnu/indicator-bluetooth/indicator-bluetooth-service
lightdm   1087  0.0  0.2 444132  9956 ?        Ssl  Jan19   0:00  _ /usr/lib/x86_64-linux-gnu/indicator-power/indicator-power-service
lightdm   1088  0.0  0.3 464956 13164 ?        Ssl  Jan19   0:00  _ /usr/lib/x86_64-linux-gnu/indicator-datetime/indicator-datetime-service
lightdm   1094  0.0  0.7 571392 30092 ?        Ssl  Jan19   0:00  _ /usr/lib/x86_64-linux-gnu/indicator-keyboard/indicator-keyboard-service --use-gtk
lightdm   1096  0.0  0.2 670336 10312 ?        Ssl  Jan19   0:00  _ /usr/lib/x86_64-linux-gnu/indicator-sound/indicator-sound-service
lightdm   1097  0.0  0.1 763320  6352 ?        Ssl  Jan19   0:00  _ /usr/lib/x86_64-linux-gnu/indicator-session/indicator-session-service
lightdm   1115  0.0  0.3 403152 14764 ?        Ssl  Jan19   0:01  _ /usr/lib/x86_64-linux-gnu/indicator-application/indicator-application-service
lightdm   1141  0.0  0.1 342668  7164 ?        S<l  Jan19   0:00  _ /usr/bin/pulseaudio --start --log-target=syslog
lightdm   1074  0.0  0.8 741020 34888 ?        Sl   Jan19   0:02 nm-applet
lightdm   1099  0.0  0.6 626012 25228 ?        Sl   Jan19   0:00 /usr/lib/unity-settings-daemon/unity-settings-daemon
rtkit     1142  0.0  0.0 183544  2984 ?        SNsl Jan19   0:00 /usr/lib/rtkit/rtkit-daemon
  └─(Caps) 0x0000000000800004=cap_dac_read_search,cap_sys_nice
root      1164  0.0  0.2 354096  9644 ?        Ssl  Jan19   0:00 /usr/lib/upower/upowerd
colord    1180  0.0  0.2 308264 10996 ?        Ssl  Jan19   0:00 /usr/lib/colord/colord
root      1206  0.0  0.0  23008  1824 tty1     Ss+  Jan19   0:00 /sbin/agetty --noclear tty1 linux
lightdm   1314  0.0  0.7 487916 29972 ?        Sl   Jan19   0:00 /usr/lib/x86_64-linux-gnu/notify-osd
systemd+ 13678  0.0  0.0 102380  2632 ?        Ssl  00:40   0:00 /lib/systemd/systemd-timesyncd
  └─(Caps) 0x0000000002000000=cap_sys_time
root     27458  0.0  0.2 298356  8360 ?        Ssl  00:41   0:00 /usr/lib/accountsservice/accounts-daemon[0m
root      3539  0.0  0.0  45240  4032 ?        Ss   00:52   0:00 /lib/systemd/systemd-udevd
mysql     5451  0.0  4.0 1508020 163580 ?      Ssl  00:52   0:07 /usr/sbin/mysqld
root      9314  0.0  0.1  65508  5416 ?        Ss   00:53   0:00 /usr/sbin/sshd -D
root      9612  0.0  0.2 278916  8232 ?        Ssl  00:53   0:00 /usr/lib/policykit-1/polkitd --no-debug
whoopsie  9692  0.0  0.3 447692 14388 ?        Ssl  00:53   0:00 /usr/bin/whoopsie -f
avahi    10098  0.0  0.0  44780   340 ?        S    00:53   0:00  _ avahi-daemon: chroot helper
root     18075  0.0  0.6 293148 28252 ?        Ss   00:53   0:00 /usr/sbin/apache2 -k start
www-data  8748  0.0  0.9 301564 38320 ?        S    01:27   0:01  _ /usr/sbin/apache2 -k start
www-data  8878  0.0  0.0   4500   752 ?        S    02:06   0:00  |   _ sh -c uname -a; w; id; /bin/sh -i
www-data  8882  0.0  0.0   4500  1568 ?        S    02:06   0:00  |       _ /bin/sh -i
www-data  8891  0.0  0.2  35832  8636 ?        S    02:10   0:00  |           _ python3 -c import pty; pty.spawn('/bin/bash')
www-data  8892  0.0  0.0  18232  3288 pts/8    Ss+  02:10   0:00  |               _ /bin/bash
www-data  9740  0.4  0.6 294516 26260 ?        S    04:19   0:24  _ /usr/sbin/apache2 -k start
www-data 19001  0.0  0.0   4500   696 ?        S    05:53   0:00  |   _ sh -c uname -a; w; id; /bin/sh -i
www-data 19048  0.0  0.0   4500   736 ?        S    05:53   0:00  |       _ /bin/sh -i
www-data 22308  0.0  0.2  35832  8860 ?        S    05:53   0:00  |           _ python3 -c import pty;pty.spawn('/bin/bash')
www-data 22309  0.0  0.0  18232  3288 pts/12   Ss   05:53   0:00  |               _ /bin/bash
www-data 22320  0.2  0.0   5188  2452 pts/12   S+   05:59   0:00  |                   _ /bin/sh ./li.sh
www-data 25584  0.0  0.0   5188   904 pts/12   S+   05:59   0:00  |                   |   _ /bin/sh ./li.sh
www-data 25588  0.0  0.0  34720  3244 pts/12   R+   05:59   0:00  |                   |   |   _ ps fauxwww
www-data 25587  0.0  0.0   5188   904 pts/12   S+   05:59   0:00  |                   |   _ /bin/sh ./li.sh
www-data 22321  0.0  0.0   4376   648 pts/12   S+   05:59   0:00  |                   _ tee lin-out.txt
www-data  9741  0.4  0.6 294628 26976 ?        S    04:19   0:25  _ /usr/sbin/apache2 -k start
www-data  9744  0.3  0.6 294236 27740 ?        S    04:20   0:21  _ /usr/sbin/apache2 -k start
www-data  9748  0.3  0.7 294400 28716 ?        S    04:20   0:20  _ /usr/sbin/apache2 -k start
www-data  9755  0.2  0.6 294552 26964 ?        S    04:23   0:16  _ /usr/sbin/apache2 -k start
www-data  9756  0.2  0.6 294268 26528 ?        S    04:24   0:13  _ /usr/sbin/apache2 -k start
www-data  9918  0.0  0.0   4500   752 ?        S    05:11   0:00  |   _ sh -c uname -a; w; id; /bin/sh -i
www-data  9922  0.0  0.0   4500   700 ?        S    05:11   0:00  |       _ /bin/sh -i
www-data  9923  0.0  0.2  35832  8672 ?        S    05:11   0:00  |           _ python3 -c import pty;pty.spawn('/bin/bash')
www-data  9924  0.0  0.0  18208  3136 pts/10   Ss+  05:11   0:00  |               _ /bin/bash
www-data  9758  0.2  0.8 299240 33676 ?        S    04:26   0:11  _ /usr/sbin/apache2 -k start
www-data  9852  0.0  0.0   4500   704 ?        S    04:43   0:00  |   _ sh -c uname -a; w; id; /bin/sh -i
www-data  9856  0.0  0.0   4500   736 ?        S    04:43   0:00  |       _ /bin/sh -i
www-data  9857  0.0  0.2  35836  8720 ?        S    04:43   0:00  |           _ python3 -c import pty;pty.spawn('/bin/bash')
www-data  9858  0.0  0.0  18208  3136 pts/9    Ss+  04:43   0:00  |               _ /bin/bash
www-data  9763  0.1  0.8 299360 32980 ?        S    04:26   0:11  _ /usr/sbin/apache2 -k start
www-data  9933  0.0  0.0   4500   696 ?        S    05:14   0:00  |   _ sh -c uname -a; w; id; /bin/sh -i
www-data  9937  0.0  0.0   4500   748 ?        S    05:14   0:00  |       _ /bin/sh -i
www-data  9938  0.0  0.2  35832  8668 ?        S    05:15   0:00  |           _ python3 -c import pty;pty.spawn('/bin/bash')
www-data  9939  0.0  0.0  18208  3368 pts/11   Ss   05:15   0:00  |               _ /bin/bash
www-data  9945  0.0  0.0   6580   724 pts/11   S+   05:15   0:00  |                   _ reset
www-data  9765  0.0  0.6 294488 26024 ?        S    04:27   0:04  _ /usr/sbin/apache2 -k start
www-data  9769  0.0  0.6 293932 25204 ?        S    04:31   0:00  _ /usr/sbin/apache2 -k start
root      8587  0.0  0.1  93276  7604 ?        Ss   01:07   0:00 /usr/sbin/cupsd -l
root      8588  0.0  0.2 274812  9436 ?        Ssl  01:07   0:00 /usr/sbin/cups-browsed

╔══════════╣ Binary processes permissions (non 'root root' and not beloging to current user)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes

╔══════════╣ Files opened by processes belonging to other users
╚ This is usually empty because of the lack of privileges to read other user processes information
COMMAND     PID   TID             USER   FD      TYPE DEVICE SIZE/OFF   NODE NAME

╔══════════╣ Processes with credentials in memory (root req)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory
gdm-password Not Found
gnome-keyring-daemon Not Found
lightdm process found (dump creds from memory as root)
vsftpd Not Found
apache2 process found (dump creds from memory as root)
sshd Not Found

╔══════════╣ Cron jobs
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs
/usr/bin/crontab
incrontab Not Found
-rw-r--r-- 1 root root     722 Apr  5  2016 /etc/crontab

/etc/cron.d:
total 32
drwxr-xr-x   2 root root  4096 Nov 16  2017 .
drwxr-xr-x 133 root root 12288 Jan 19 07:21 ..
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder
-rw-r--r--   1 root root   244 Dec 28  2014 anacron
-rw-r--r--   1 root root   670 Mar  1  2016 php
-rw-r--r--   1 root root   190 Nov 14  2017 popularity-contest

/etc/cron.daily:
total 76
drwxr-xr-x   2 root root  4096 Jan 19 07:20 .
drwxr-xr-x 133 root root 12288 Jan 19 07:21 ..
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder
-rwxr-xr-x   1 root root   311 Dec 28  2014 0anacron
-rwxr-xr-x   1 root root   539 Apr  5  2016 apache2
-rwxr-xr-x   1 root root   376 Mar 31  2016 apport
-rwxr-xr-x   1 root root  1474 Jun 19  2017 apt-compat
-rwxr-xr-x   1 root root   355 May 22  2012 bsdmainutils
-rwxr-xr-x   1 root root   384 Oct  5  2014 cracklib-runtime
-rwxr-xr-x   1 root root  1597 Nov 26  2015 dpkg
-rwxr-xr-x   1 root root   372 May  6  2015 logrotate
-rwxr-xr-x   1 root root  1293 Nov  6  2015 man-db
-rwxr-xr-x   1 root root   435 Nov 18  2014 mlocate
-rwxr-xr-x   1 root root   249 Nov 12  2015 passwd
-rwxr-xr-x   1 root root  3449 Feb 26  2016 popularity-contest
-rwxr-xr-x   1 root root   214 May 24  2016 update-notifier-common
-rwxr-xr-x   1 root root  1046 May 19  2016 upstart

/etc/cron.hourly:
total 20
drwxr-xr-x   2 root root  4096 Aug  1  2017 .
drwxr-xr-x 133 root root 12288 Jan 19 07:21 ..
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder

/etc/cron.monthly:
total 24
drwxr-xr-x   2 root root  4096 Aug  1  2017 .
drwxr-xr-x 133 root root 12288 Jan 19 07:21 ..
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder
-rwxr-xr-x   1 root root   313 Dec 28  2014 0anacron

/etc/cron.weekly:
total 36
drwxr-xr-x   2 root root  4096 Jan 19 07:20 .
drwxr-xr-x 133 root root 12288 Jan 19 07:21 ..
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder
-rwxr-xr-x   1 root root   312 Dec 28  2014 0anacron
-rwxr-xr-x   1 root root    86 Apr 13  2016 fstrim
-rwxr-xr-x   1 root root   771 Nov  6  2015 man-db
-rwxr-xr-x   1 root root   211 May 24  2016 update-notifier-common

/var/spool/anacron:
total 20
drwxr-xr-x 2 root root 4096 Nov 14  2017 .
drwxr-xr-x 7 root root 4096 Aug  1  2017 ..
-rw------- 1 root root    9 Jan 19 07:35 cron.daily
-rw------- 1 root root    9 Jan 18 15:59 cron.monthly
-rw------- 1 root root    9 Jan 18 15:56 cron.weekly

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin



SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
HOME=/root
LOGNAME=root

1	5	cron.daily	run-parts --report /etc/cron.daily
7	10	cron.weekly	run-parts --report /etc/cron.weekly
@monthly	15	cron.monthly	run-parts --report /etc/cron.monthly

╔══════════╣ Systemd PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

╔══════════╣ Analyzing .service files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#services
/etc/systemd/system/multi-user.target.wants/networking.service is executing some relative path
/etc/systemd/system/network-online.target.wants/networking.service is executing some relative path
You can't write on systemd PATH

╔══════════╣ System timers
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers
NEXT                         LEFT          LAST                         PASSED        UNIT                         ACTIVATES
Thu 2022-01-20 06:03:31 EST  4min 1s left  Wed 2022-01-19 06:35:03 EST  23h ago       apt-daily-upgrade.timer      apt-daily-upgrade.service
Thu 2022-01-20 11:09:32 EST  5h 10min left Thu 2022-01-20 03:03:06 EST  2h 56min ago  apt-daily.timer              apt-daily.service
Thu 2022-01-20 21:21:55 EST  15h left      Tue 2022-01-18 13:59:51 EST  1 day 15h ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
n/a                          n/a           Tue 2022-01-18 15:44:29 EST  1 day 14h ago snapd.refresh.timer         
n/a                          n/a           n/a                          n/a           snapd.snap-repair.timer      snapd.snap-repair.service
n/a                          n/a           n/a                          n/a           ureadahead-stop.timer        ureadahead-stop.service

╔══════════╣ Analyzing .timer files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers

╔══════════╣ Analyzing .socket files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets
/etc/systemd/system/sockets.target.wants/avahi-daemon.socket is calling this writable listener: /var/run/avahi-daemon/socket
/etc/systemd/system/sockets.target.wants/uuidd.socket is calling this writable listener: /run/uuidd/request
/lib/systemd/system/avahi-daemon.socket is calling this writable listener: /var/run/avahi-daemon/socket
/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog
/lib/systemd/system/systemd-bus-proxyd.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/lib/systemd/system/uuidd.socket is calling this writable listener: /run/uuidd/request

╔══════════╣ Unix Sockets Listening
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets
/com/ubuntu/upstart-session/108/1072
/run/NetworkManager/private-dhcp
  └─(Read )
/run/acpid.socket
  └─(Read Write)
/run/avahi-daemon/socket
  └─(Read Write)
/run/cups/cups.sock
  └─(Read Write)
/run/dbus/system_bus_socket
  └─(Read Write)
/run/mysqld/mysqld.sock
  └─(Read Write)
/run/snapd-snap.socket
  └─(Read Write)
/run/snapd.socket
  └─(Read Write)
/run/systemd/cgroups-agent
/run/systemd/fsck.progress
/run/systemd/journal/dev-log
  └─(Read Write)
/run/systemd/journal/socket
  └─(Read Write)
/run/systemd/journal/stdout
  └─(Read Write)
/run/systemd/journal/syslog
  └─(Read Write)
/run/systemd/notify
  └─(Read Write)
/run/systemd/private
  └─(Read Write)
/run/udev/control
/run/user/108/pulse/native
/run/user/108/systemd/private
/run/uuidd/request
  └─(Read Write)
/tmp/.X11-unix/X0
  └─(Read Write)
/tmp/dbus-B2YWCB1CuU
/tmp/dbus-ewC2Rgvuxr
/var/run/NetworkManager/private-dhcp
  └─(Read )
/var/run/avahi-daemon/socket
  └─(Read Write)
/var/run/cups/cups.sock
  └─(Read Write)
/var/run/dbus/system_bus_socket
  └─(Read Write)
/var/run/mysqld/mysqld.sock
  └─(Read Write)

╔══════════╣ D-Bus config files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus
Possible weak user policy found on /etc/dbus-1/system.d/avahi-dbus.conf (  <policy user="avahi">)
Possible weak user policy found on /etc/dbus-1/system.d/avahi-dbus.conf (  <policy group="netdev">)
Possible weak user policy found on /etc/dbus-1/system.d/bluetooth.conf (  <policy group="bluetooth">
  <policy group="lp">)
Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf (        <policy user="dnsmasq">)
Possible weak user policy found on /etc/dbus-1/system.d/kerneloops.dbus (  <policy user="kernoops">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.ColorManager.conf (  <policy user="colord">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.NetworkManager.conf (        <policy user="whoopsie">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.RealtimeKit1.conf (  <policy user="rtkit">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.network1.conf (        <policy user="systemd-network">)
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.resolve1.conf (        <policy user="systemd-resolve">)
Possible weak user policy found on /etc/dbus-1/system.d/pulseaudio-system.conf (  <policy user="pulse">)
Possible weak user policy found on /etc/dbus-1/system.d/wpa_supplicant.conf (        <policy group="netdev">)

╔══════════╣ D-Bus Service Objects list
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus
NAME                                          PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION        
:1.101                                      29629 busctl          www-data         :1.101        apache2.service           -          -                  
:1.2                                          825 systemd-logind  root             :1.2          systemd-logind.service    -          -                  
:1.21                                         945 lightdm         root             :1.21         lightdm.service           -          -                  
:1.22                                         976 Xorg            root             :1.22         lightdm.service           -          -                  
:1.23                                        1000 lightdm         root             :1.23         session-c1.scope          c1         -                  
:1.26                                        1018 unity-greeter   lightdm          :1.26         session-c1.scope          c1         -                  
:1.27                                        1072 upstart         lightdm          :1.27         session-c1.scope          c1         -                  
:1.28                                        1085 indicator-messa lightdm          :1.28         session-c1.scope          c1         -                  
:1.29                                        1086 indicator-bluet lightdm          :1.29         session-c1.scope          c1         -                  
:1.30                                        1097 indicator-sessi lightdm          :1.30         session-c1.scope          c1         -                  
:1.31                                        1087 indicator-power lightdm          :1.31         session-c1.scope          c1         -                  
:1.32                                        1088 indicator-datet lightdm          :1.32         session-c1.scope          c1         -                  
:1.34                                        1142 rtkit-daemon    root             :1.34         rtkit-daemon.service      -          -                  
:1.35                                        1094 indicator-keybo lightdm          :1.35         session-c1.scope          c1         -                  
:1.36                                        1141 pulseaudio      lightdm          :1.36         session-c1.scope          c1         -                  
:1.37                                        1074 nm-applet       lightdm          :1.37         session-c1.scope          c1         -                  
:1.38                                        1099 unity-settings- lightdm          :1.38         session-c1.scope          c1         -                  
:1.39                                        1096 indicator-sound lightdm          :1.39         session-c1.scope          c1         -                  
:1.40                                        1164 upowerd         root             :1.40         upower.service            -          -                  
:1.41                                        1180 colord          colord           :1.41         colord.service            -          -                  
:1.5                                          824 NetworkManager  root             :1.5          NetworkManager.service    -          -                  
:1.50                                        1433 dnsmasq         root             :1.50         NetworkManager.service    -          -                  
:1.57                                           1 systemd         root             :1.57         init.scope                -          -                  
:1.58                                       27458 accounts-daemon[0m root             :1.58         accounts-daemon.service   -          -                  
:1.6                                          819 ModemManager    root             :1.6          ModemManager.service      -          -                  
:1.65                                        9612 polkitd         root             :1.65         polkitd.service           -          -                  
:1.66                                        9692 whoopsie        whoopsie         :1.66         whoopsie.service          -          -                  
:1.67                                        9692 whoopsie        whoopsie         :1.67         whoopsie.service          -          -                  
:1.70                                       10097 avahi-daemon    avahi            :1.70         avahi-daemon.service      -          -                  
:1.78                                        8587 cupsd           root             :1.78         cups.service              -          -                  
:1.79                                        8588 cups-browsed    root             :1.79         cups-browsed.service      -          -                  
:1.80                                        8588 cups-browsed    root             :1.80         cups-browsed.service      -          -                  
com.hp.hplip                                    - -               -                (activatable) -                         -         
com.ubuntu.LanguageSelector                     - -               -                (activatable) -                         -         
com.ubuntu.SoftwareProperties                   - -               -                (activatable) -                         -         
com.ubuntu.SystemService                        - -               -                (activatable) -                         -         
com.ubuntu.USBCreator                           - -               -                (activatable) -                         -         
com.ubuntu.WhoopsiePreferences                  - -               -                (activatable) -                         -         
fi.epitest.hostap.WPASupplicant                 - -               -                (activatable) -                         -         
fi.w1.wpa_supplicant1                           - -               -                (activatable) -                         -         
org.bluez                                       - -               -                (activatable) -                         -         
org.debian.apt                                  - -               -                (activatable) -                         -         
org.freedesktop.Accounts                    27458 accounts-daemon[0m root             :1.58         accounts-daemon.service   -          -                  
org.freedesktop.Avahi                       10097 avahi-daemon    avahi            :1.70         avahi-daemon.service      -          -                  
org.freedesktop.ColorManager                 1180 colord          colord           :1.41         colord.service            -          -                  
org.freedesktop.DBus                          818 dbus-daemon[0m     messagebus       org.freedesktop.DBus dbus.service              -          -                  
org.freedesktop.DisplayManager                945 lightdm         root             :1.21         lightdm.service           -          -                  
org.freedesktop.ModemManager1                 819 ModemManager    root             :1.6          ModemManager.service      -          -                  
org.freedesktop.NetworkManager                824 NetworkManager  root             :1.5          NetworkManager.service    -          -                  
org.freedesktop.NetworkManager.dnsmasq       1433 dnsmasq         root             :1.50         NetworkManager.service    -          -                  
org.freedesktop.PackageKit                      - -               -                (activatable) -                         -         
org.freedesktop.PolicyKit1                   9612 polkitd         root             :1.65         polkitd.service           -          -                  
org.freedesktop.RealtimeKit1                 1142 rtkit-daemon    root             :1.34         rtkit-daemon.service      -          -                  
org.freedesktop.UDisks2                         - -               -                (activatable) -                         -         
org.freedesktop.UPower                       1164 upowerd         root             :1.40         upower.service            -          -                  
org.freedesktop.fwupd                           - -               -                (activatable) -                         -         
org.freedesktop.hostname1                       - -               -                (activatable) -                         -         
org.freedesktop.locale1                         - -               -                (activatable) -                         -         
org.freedesktop.login1                        825 systemd-logind  root             :1.2          systemd-logind.service    -          -                  
org.freedesktop.network1                        - -               -                (activatable) -                         -         
org.freedesktop.nm_dispatcher                   - -               -                (activatable) -                         -         
org.freedesktop.resolve1                        - -               -                (activatable) -                         -         
org.freedesktop.systemd1                        1 systemd         root             :1.57         init.scope                -          -                  
org.freedesktop.thermald                        - -               -                (activatable) -                         -         
org.freedesktop.timedate1                       - -               -                (activatable) -                         -         
org.opensuse.CupsPkHelper.Mechanism             - -               -                (activatable) -                         -         


                                        ╔═════════════════════╗
════════════════════════════════════════╣ Network Information ╠════════════════════════════════════════
                                        ╚═════════════════════╝
╔══════════╣ Hostname, hosts and DNS
vtcsec
127.0.0.1	localhost
127.0.1.1	vtcsec

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
nameserver 127.0.1.1
search Fawry-eg.local

╔══════════╣ Interfaces
# symbolic names for networks, see networks(5) for more information
link-local 169.254.0.0
ens33     Link encap:Ethernet  HWaddr 00:0c:29:00:f3:77  
          inet addr:172.5.10.104  Bcast:172.5.10.255  Mask:255.255.255.0
          inet6 addr: fe80::a6bc:3424:7dac:4edf/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3173490 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2783688 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:1010650096 (1.0 GB)  TX bytes:1149779867 (1.1 GB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:4802 errors:0 dropped:0 overruns:0 frame:0
          TX packets:4802 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:711585 (711.5 KB)  TX bytes:711585 (711.5 KB)


╔══════════╣ Active Ports
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports
tcp        0      0 127.0.1.1:53            0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -               
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               
tcp6       0      0 :::22                   :::*                    LISTEN      -               
tcp6       0      0 ::1:631                 :::*                    LISTEN      -               
tcp6       0      0 :::80                   :::*                    LISTEN      -               

╔══════════╣ Can I sniff with tcpdump?
No



                                         ╔═══════════════════╗
═════════════════════════════════════════╣ Users Information ╠═════════════════════════════════════════
                                         ╚═══════════════════╝
╔══════════╣ My user
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#users
uid=33(www-data) gid=33(www-data) groups=33(www-data)

╔══════════╣ Do I have PGP keys?
/usr/bin/gpg
netpgpkeys Not Found
netpgp Not Found

╔══════════╣ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid

╔══════════╣ Checking sudo tokens
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens
ptrace protection is enabled (1)
gdb was found in PATH

╔══════════╣ Checking Pkexec policy
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2

[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin

╔══════════╣ Superusers
root:x:0:0:root:/root:/bin/bash

╔══════════╣ Users with console
marlinspike:x:1000:1000:marlinspike,,,:/home/marlinspike:/bin/bash
root:x:0:0:root:/root:/bin/bash

╔══════════╣ All users & groups
uid=0(root) gid=0(root) groups=0(root)
uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync)
uid=1000(marlinspike) gid=1000(marlinspike) groups=1000(marlinspike),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),113(lpadmin),128(sambashare)
uid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network)
uid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve)
uid=103(systemd-bus-proxy) gid=105(systemd-bus-proxy) groups=105(systemd-bus-proxy)
uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm)
uid=105(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=106(messagebus) gid=110(messagebus) groups=110(messagebus)
uid=107(uuidd) gid=111(uuidd) groups=111(uuidd)
uid=108(lightdm) gid=114(lightdm) groups=114(lightdm)
uid=109(whoopsie) gid=117(whoopsie) groups=117(whoopsie)
uid=110(avahi-autoipd) gid=119(avahi-autoipd) groups=119(avahi-autoipd)
uid=111(avahi) gid=120(avahi) groups=120(avahi)
uid=112(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)
uid=113(colord) gid=123(colord) groups=123(colord)
uid=114(speech-dispatcher) gid=29(audio) groups=29(audio)
uid=115(hplip) gid=7(lp) groups=7(lp)
uid=116(kernoops) gid=65534(nogroup) groups=65534(nogroup)
uid=117(pulse) gid=124(pulse) groups=124(pulse),29(audio)
uid=118(rtkit) gid=126(rtkit) groups=126(rtkit)
uid=119(saned) gid=127(saned) groups=127(saned),122(scanner)
uid=120(usbmux) gid=46(plugdev) groups=46(plugdev)
uid=121(mysql) gid=129(mysql) groups=129(mysql)
uid=122(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=5(games) gid=60(games) groups=60(games)
uid=6(man) gid=12(man) groups=12(man)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=9(news) gid=9(news) groups=9(news)

╔══════════╣ Login now
 05:59:35 up  8:53,  0 users,  load average: 0.28, 0.16, 0.10
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT

╔══════════╣ Last logons

wtmp begins Tue Jan 18 13:49:30 2022

╔══════════╣ Last time logon each user
Username         Port     From             Latest

╔══════════╣ Do not forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)

╔══════════╣ Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!



                                       ╔══════════════════════╗
═══════════════════════════════════════╣ Software Information ╠═══════════════════════════════════════
                                       ╚══════════════════════╝
╔══════════╣ Useful software
/usr/bin/base64
/usr/bin/g++
/usr/bin/gcc
/usr/bin/gdb
/usr/bin/make
/bin/nc
/bin/netcat
/usr/bin/perl
/usr/bin/php
/bin/ping
/usr/bin/python
/usr/bin/python2
/usr/bin/python2.7
/usr/bin/python3
/usr/bin/sudo
/usr/bin/wget
/usr/bin/xterm

╔══════════╣ Installed Compilers
ii  g++                                        4:5.3.1-1ubuntu1                                amd64        GNU C++ compiler
ii  g++-5                                      5.4.0-6ubuntu1~16.04.12                         amd64        GNU C++ compiler
ii  gcc                                        4:5.3.1-1ubuntu1                                amd64        GNU C compiler
ii  gcc-5                                      5.4.0-6ubuntu1~16.04.12                         amd64        GNU C compiler
ii  hardening-includes                         2.7ubuntu2                                      all          Makefile for enabling compiler flags for security hardening
/usr/bin/gcc

╔══════════╣ MySQL version
mysql  Ver 14.14 Distrib 5.7.33, for Linux (x86_64) using  EditLine wrapper

═╣ MySQL connection using default root/root ........... No
═╣ MySQL connection using root/toor ................... No
═╣ MySQL connection using root/NOPASS ................. No

╔══════════╣ Searching mysql credentials and exec
From '/etc/mysql/mysql.conf.d/mysqld.cnf' Mysql user: user		= mysql
Found readable /etc/mysql/my.cnf
!includedir /etc/mysql/conf.d/
!includedir /etc/mysql/mysql.conf.d/

╔══════════╣ Analyzing MariaDB Files (limit 70)

-rw------- 1 root root 317 Jan 19 07:19 /etc/mysql/debian.cnf

╔══════════╣ Analyzing Apache Files (limit 70)
Version: Server version: Apache/2.4.18 (Ubuntu)
Server built:   2020-08-12T21:35:50
httpd Not Found

══╣ PHP exec extensions
/etc/apache2/mods-enabled/php7.0.conf-<FilesMatch ".+\.ph(p[3457]?|t|tml)$">
/etc/apache2/mods-enabled/php7.0.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-enabled/php7.0.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-enabled/php7.0.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/conf-available/php7.0-cgi.conf-
/etc/apache2/conf-available/php7.0-cgi.conf:# application/x-httpd-php                        phtml pht php
/etc/apache2/conf-available/php7.0-cgi.conf:# application/x-httpd-php3                       php3
/etc/apache2/conf-available/php7.0-cgi.conf:# application/x-httpd-php4                       php4
/etc/apache2/conf-available/php7.0-cgi.conf:# application/x-httpd-php5                       php
/etc/apache2/conf-available/php7.0-cgi.conf-<FilesMatch ".+\.ph(p[3457]?|t|tml)$">
/etc/apache2/conf-available/php7.0-cgi.conf:    SetHandler application/x-httpd-php
/etc/apache2/conf-available/php7.0-cgi.conf-</FilesMatch>
/etc/apache2/conf-available/php7.0-cgi.conf:# application/x-httpd-php-source                 phps
/etc/apache2/conf-available/php7.0-cgi.conf-<FilesMatch ".+\.phps$">
/etc/apache2/conf-available/php7.0-cgi.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/conf-available/php7.0-cgi.conf-#</Directory>
/etc/apache2/conf-available/php7.0-cgi.conf:#Action application/x-httpd-php /cgi-bin/php7.0
--
/etc/apache2/mods-available/php7.0.conf-<FilesMatch ".+\.ph(p[3457]?|t|tml)$">
/etc/apache2/mods-available/php7.0.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php7.0.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php7.0.conf:    SetHandler application/x-httpd-php-source
drwxr-xr-x 2 root root 4096 Nov 16  2017 /etc/apache2/sites-enabled
drwxr-xr-x 2 root root 4096 Nov 16  2017 /etc/apache2/sites-enabled
lrwxrwxrwx 1 root root 35 Nov 16  2017 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf


-rw-r--r-- 1 root root 1332 Mar 19  2016 /etc/apache2/sites-available/000-default.conf
<VirtualHost *:80>
	# The ServerName directive sets the request scheme, hostname and port that
	# the server uses to identify itself. This is used when creating
	# redirection URLs. In the context of virtual hosts, the ServerName
	# specifies what hostname must appear in the request's Host: header to
	# match this virtual host. For the default virtual host (this file) this
	# value is not decisive as it is used as a last resort host regardless.
	# However, you must set it for any further virtual host explicitly.
	#ServerName www.example.com
	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html
	# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
	# error, crit, alert, emerg.
	# It is also possible to configure the loglevel for particular
	# modules, e.g.
	#LogLevel info ssl:warn
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
	# For most configuration files from conf-available/, which are
	# enabled or disabled at a global level, it is possible to
	# include a line for only one particular virtual host. For example the
	# following line enables the CGI configuration for this host only
	# after it has been globally disabled with "a2disconf".
	#Include conf-available/serve-cgi-bin.conf
</VirtualHost>
# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
lrwxrwxrwx 1 root root 35 Nov 16  2017 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf
<VirtualHost *:80>
	# The ServerName directive sets the request scheme, hostname and port that
	# the server uses to identify itself. This is used when creating
	# redirection URLs. In the context of virtual hosts, the ServerName
	# specifies what hostname must appear in the request's Host: header to
	# match this virtual host. For the default virtual host (this file) this
	# value is not decisive as it is used as a last resort host regardless.
	# However, you must set it for any further virtual host explicitly.
	#ServerName www.example.com
	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html
	# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
	# error, crit, alert, emerg.
	# It is also possible to configure the loglevel for particular
	# modules, e.g.
	#LogLevel info ssl:warn
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
	# For most configuration files from conf-available/, which are
	# enabled or disabled at a global level, it is possible to
	# include a line for only one particular virtual host. For example the
	# following line enables the CGI configuration for this host only
	# after it has been globally disabled with "a2disconf".
	#Include conf-available/serve-cgi-bin.conf
</VirtualHost>
# vim: syntax=apache ts=4 sw=4 sts=4 sr noet

-rw-r--r-- 1 root root 70999 Aug  9  2017 /etc/php/7.0/apache2/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysqli.allow_persistent = On
pgsql.allow_persistent = On
-rw-r--r-- 1 root root 70999 Aug  9  2017 /etc/php/7.0/cgi/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysqli.allow_persistent = On
pgsql.allow_persistent = On
-rw-r--r-- 1 root root 70656 Aug  9  2017 /etc/php/7.0/cli/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysqli.allow_persistent = On
pgsql.allow_persistent = On

╔══════════╣ Analyzing Wordpress Files (limit 70)
-rw-r--r-- 1 www-data www-data 2836 Nov 16  2017 /var/www/html/secret/wp-config.php
define('DB_NAME', 'wp_myblog');
define('DB_USER', 'root');
define('DB_PASSWORD', 'arootmysqlpass');
define('DB_HOST', 'localhost');

╔══════════╣ Analyzing Rsync Files (limit 70)
-rw-r--r-- 1 root root 1044 Feb 14  2020 /usr/share/doc/rsync/examples/rsyncd.conf
[ftp]
	comment = public archive
	path = /var/www/pub
	use chroot = yes
	lock file = /var/lock/rsyncd
	read only = yes
	list = yes
	uid = nobody
	gid = nogroup
	strict modes = yes
	ignore errors = no
	ignore nonreadable = yes
	transfer logging = no
	timeout = 600
	refuse options = checksum dry-run
	dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz


╔══════════╣ Analyzing Wifi Connections Files (limit 70)
drwxr-xr-x 2 root root 4096 Feb 21  2017 /etc/NetworkManager/system-connections
drwxr-xr-x 2 root root 4096 Feb 21  2017 /etc/NetworkManager/system-connections


╔══════════╣ Analyzing Ldap Files (limit 70)
The password hash is from the {SSHA} to 'structural'
drwxr-xr-x 2 root root 4096 Jan 19 07:19 /etc/ldap


╔══════════╣ Searching ssl/ssh files
Port 22
PermitRootLogin prohibit-password
PubkeyAuthentication yes
PermitEmptyPasswords no
ChallengeResponseAuthentication no
UsePAM yes

══╣ Possible private SSH keys were found!
/etc/ImageMagick-6/mime.xml
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_sftp/ssh_host_rsa_key
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_sftp/test_dsa_key
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_sftp/test_rsa_key
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_sftp/ssh_host_dsa_key
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_tls/client-cert.pem
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_tls/server-cert.pem
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_tls/ca-cert.pem
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_tls/key-nul-subjaltname.pem
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_sftp/ssh_host_rsa_key
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_sftp/test_dsa_key
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_sftp/test_rsa_key
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_sftp/ssh_host_dsa_key
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_tls/client-cert.pem
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_tls/server-cert.pem
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_tls/ca-cert.pem
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_tls/key-nul-subjaltname.pem

══╣ Some certificates were found (out limited):
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_tls/ca-cert.pem
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_tls/key-nul-subjaltname.pem
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_tls/ca-cert.pem
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_tls/key-nul-subjaltname.pem
22320PSTORAGE_CERTSBIN

══╣ Some client certificates were found:
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/etc/modules/mod_tls/server-cert.p12
/home/marlinspike/proftpd-1.3.3c/tests/t/etc/modules/mod_tls/server-cert.p12

gpg-connect-agent: no running gpg-agent - starting '/usr/bin/gpg-agent'
gpg-connect-agent: failed to create temporary file '/var/www/.gnupg/.#lk0x00005637c2e02c50.vtcsec.30698': No such file or directory
gpg-connect-agent: can't connect to the agent: No such file or directory
gpg-connect-agent: error sending standard options: No agent running
══╣ Some home ssh config file was found
/usr/share/doc/openssh-client/examples/sshd_config
AuthorizedKeysFile	.ssh/authorized_keys
Subsystem	sftp	/usr/lib/openssh/sftp-server

══╣ /etc/hosts.allow file found, trying to read the rules:
/etc/hosts.allow


Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes
    GSSAPIDelegateCredentials no

╔══════════╣ Analyzing PAM Auth Files (limit 70)
drwxr-xr-x 2 root root 4096 Jan 19 07:20 /etc/pam.d
-rw-r--r-- 1 root root 2133 Mar 16  2017 /etc/pam.d/sshd


╔══════════╣ Passwords inside pam.d
/etc/pam.d/lightdm:auth    sufficient      pam_succeed_if.so user ingroup nopasswdlogin



╔══════════╣ Analyzing Cloud Credentials Files (limit 70)
drwxr-xr-x 2 root root 4096 Aug  1  2017 /usr/share/help/C/web-credentials










╔══════════╣ Analyzing Keyring Files (limit 70)
drwxr-xr-x 2 root root 4096 Aug  1  2017 /usr/share/keyrings
drwxr-xr-x 2 root root 4096 Aug  1  2017 /var/lib/apt/keyrings




╔══════════╣ Searching uncommon passwd files (splunk)
passwd file: /etc/pam.d/passwd
passwd file: /etc/passwd
passwd file: /usr/share/bash-completion/completions/passwd
passwd file: /usr/share/lintian/overrides/passwd

╔══════════╣ Analyzing PGP-GPG Files (limit 70)
/usr/bin/gpg
gpg Not Found
netpgpkeys Not Found
netpgp Not Found

-rw-r--r-- 1 root root 12255 Aug  1  2017 /etc/apt/trusted.gpg
-rw-r--r-- 1 root root 4114 Jun 14  2018 /usr/share/gnupg2/distsigkey.gpg
-rw-r--r-- 1 root root 12335 May 18  2012 /usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 0 May 18  2012 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 18  2012 /usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 2256 Feb 26  2016 /usr/share/popularity-contest/debian-popcon.gpg
-rw-r--r-- 1 root root 12335 Aug  1  2017 /var/lib/apt/keyrings/ubuntu-archive-keyring.gpg

drwx------ 3 marlinspike marlinspike 4096 Nov 17  2017 /home/marlinspike/.gnupg

╔══════════╣ Kubernetes information

╔══════════╣ Analyzing Postfix Files (limit 70)
-rw-r--r-- 1 root root 694 May 18  2016 /usr/share/bash-completion/completions/postfix


╔══════════╣ Analyzing FTP Files (limit 70)


-rw-r--r-- 1 root root 69 Aug  9  2017 /etc/php/7.0/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Oct  8  2020 /usr/share/php7.0-common/common/ftp.ini






╔══════════╣ Analyzing Windows Files Files (limit 70)






















lrwxrwxrwx 1 root root 20 Nov 16  2017 /etc/alternatives/my.cnf -> /etc/mysql/mysql.cnf
lrwxrwxrwx 1 root root 24 Nov 16  2017 /etc/mysql/my.cnf -> /etc/alternatives/my.cnf
-rw-r--r-- 1 root root 81 Jan 19 07:19 /var/lib/dpkg/alternatives/my.cnf




-rw-r--r-- 1 root root 553164 Feb 18  2016 /usr/share/gutenprint/5.2/xml/printers.xml























╔══════════╣ Analyzing Other Interesting Files Files (limit 70)
-rw-r--r-- 1 root root 3771 Aug 31  2015 /etc/skel/.bashrc
-rw-r--r-- 1 marlinspike marlinspike 3771 Nov 14  2017 /home/marlinspike/.bashrc





-rw-r--r-- 1 root root 655 May 16  2017 /etc/skel/.profile
-rw-r--r-- 1 marlinspike marlinspike 655 Nov 14  2017 /home/marlinspike/.profile



-rw-r--r-- 1 marlinspike marlinspike 0 Nov 14  2017 /home/marlinspike/.sudo_as_admin_successful



                                         ╔═══════════════════╗
═════════════════════════════════════════╣ Interesting Files ╠═════════════════════════════════════════
                                         ╚═══════════════════╝
╔══════════╣ SUID - Check easy privesc, exploits and write perms
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid
-rwsr-xr-- 1 root messagebus 42K Jun 11  2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 10K Mar 27  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x 1 root root 15K Mar 27  2019 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-sr-x 1 root root 11K Apr  8  2021 /usr/lib/xorg/Xorg.wrap
-rwsr-xr-x 1 root root 109K Feb  7  2021 /usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)
-rwsr-xr-x 1 root root 19K Mar 18  2017 /usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox
-rwsr-xr-x 1 root root 419K Mar  4  2019 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 53K May 16  2017 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 23K Mar 27  2019 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)
-rwsr-xr-x 1 root root 39K May 16  2017 /usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 40K May 16  2017 /usr/bin/chsh
-rwsr-xr-x 1 root root 134K Jan 20  2021 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-x 1 root root 49K May 16  2017 /usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 74K May 16  2017 /usr/bin/gpasswd
-rwsr-xr-- 1 root dip 386K Jul 23  2020 /usr/sbin/pppd  --->  Apple_Mac_OSX_10.4.8(05-2007)
-rwsr-xr-x 1 root root 44K May  7  2014 /bin/ping6
-rwsr-xr-x 1 root root 31K Jul 12  2016 /bin/fusermount
-rwsr-xr-x 1 root root 27K Jun 14  2017 /bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 40K May 16  2017 /bin/su
-rwsr-xr-x 1 root root 44K May  7  2014 /bin/ping
-rwsr-xr-x 1 root root 40K Jun 14  2017 /bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8

╔══════════╣ SGID
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid
-rwsr-sr-x 1 root root 11K Apr  8  2021 /usr/lib/xorg/Xorg.wrap
-rwxr-sr-x 1 root mail 14K Jul  8  2020 /usr/lib/evolution/camel-lock-helper-1.2
-rwxr-sr-x 1 root utmp 10K Mar 11  2016 /usr/lib/x86_64-linux-gnu/utempter/utempter
-rwxr-sr-x 1 root ssh 351K Mar  4  2019 /usr/bin/ssh-agent
-rwxr-sr-x 1 root mlocate 39K Nov 18  2014 /usr/bin/mlocate
-rwxr-sr-x 1 root tty 15K Mar  1  2016 /usr/bin/bsd-write
-rwxr-sr-x 1 root tty 27K Jun 14  2017 /usr/bin/wall
-rwxr-sr-x 1 root shadow 23K May 16  2017 /usr/bin/expiry
-rwxr-sr-x 1 root shadow 61K May 16  2017 /usr/bin/chage
-rwxr-sr-x 1 root crontab 36K Apr  5  2016 /usr/bin/crontab
-rwxr-sr-x 1 root shadow 35K Mar 16  2016 /sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 35K Mar 16  2016 /sbin/pam_extrausers_chkpwd

╔══════════╣ Checking misconfigurations of ld.so
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so
/etc/ld.so.conf
include /etc/ld.so.conf.d/*.conf

/etc/ld.so.conf.d
  /etc/ld.so.conf.d/fakeroot-x86_64-linux-gnu.conf
/usr/lib/x86_64-linux-gnu/libfakeroot
  /etc/ld.so.conf.d/libc.conf
/usr/local/lib
  /etc/ld.so.conf.d/x86_64-linux-gnu.conf
/lib/x86_64-linux-gnu
/usr/lib/x86_64-linux-gnu
  /etc/ld.so.conf.d/x86_64-linux-gnu_EGL.conf
/usr/lib/x86_64-linux-gnu/mesa-egl
  /etc/ld.so.conf.d/x86_64-linux-gnu_GL.conf
/usr/lib/x86_64-linux-gnu/mesa

╔══════════╣ Capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities
Current capabilities:
Current: =
CapInh:	0000000000000000
CapPrm:	0000000000000000
CapEff:	0000000000000000
CapBnd:	0000003fffffffff
CapAmb:	0000000000000000

Shell capabilities:
0x0000000000000000=
CapInh:	0000000000000000
CapPrm:	0000000000000000
CapEff:	0000000000000000
CapBnd:	0000003fffffffff
CapAmb:	0000000000000000

Files with capabilities (limited to 50):
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep
/usr/bin/arping = cap_net_raw+ep
/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep
/usr/bin/gnome-keyring-daemon = cap_ipc_lock+ep
/usr/bin/traceroute6.iputils = cap_net_raw+ep
/usr/bin/mtr = cap_net_raw+ep

╔══════════╣ Files with ACLs (limited to 50)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls
files with acls in searched folders Not Found

╔══════════╣ .sh files in path
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path
/usr/sbin/alsa-info.sh
/usr/bin/gettext.sh
/usr/bin/amuFormat.sh

╔══════════╣ Unexpected in root
/initrd.img.old
/vmlinuz.old
/initrd.img
/vmlinuz

╔══════════╣ Files (scripts) in /etc/profile.d/
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files
total 36
drwxr-xr-x   2 root root  4096 Jan 19 07:20 .
drwxr-xr-x 133 root root 12288 Jan 19 07:21 ..
-rw-r--r--   1 root root    40 Feb 16  2017 appmenu-qt5.sh
-rw-r--r--   1 root root   833 Feb  7  2021 apps-bin-path.sh
-rw-r--r--   1 root root   663 May 18  2016 bash_completion.sh
-rw-r--r--   1 root root  1003 Dec 29  2015 cedilla-portuguese.sh
-rw-r--r--   1 root root  1941 Mar 16  2016 vte-2.91.sh

╔══════════╣ Permissions in init, init.d, systemd, and rc.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d

═╣ Hashes inside passwd file? ........... No
═╣ Writable passwd file? ................ /etc/passwd is writable
═╣ Credentials in fstab/mtab? ........... No
═╣ Can I read shadow files? ............. root:!:17484:0:99999:7:::
daemon:*:17379:0:99999:7:::
bin:*:17379:0:99999:7:::
sys:*:17379:0:99999:7:::
sync:*:17379:0:99999:7:::
games:*:17379:0:99999:7:::
man:*:17379:0:99999:7:::
lp:*:17379:0:99999:7:::
mail:*:17379:0:99999:7:::
news:*:17379:0:99999:7:::
uucp:*:17379:0:99999:7:::
proxy:*:17379:0:99999:7:::
www-data:*:17379:0:99999:7:::
backup:*:17379:0:99999:7:::
list:*:17379:0:99999:7:::
irc:*:17379:0:99999:7:::
gnats:*:17379:0:99999:7:::
nobody:*:17379:0:99999:7:::
systemd-timesync:*:17379:0:99999:7:::
systemd-network:*:17379:0:99999:7:::
systemd-resolve:*:17379:0:99999:7:::
systemd-bus-proxy:*:17379:0:99999:7:::
syslog:*:17379:0:99999:7:::
_apt:*:17379:0:99999:7:::
messagebus:*:17379:0:99999:7:::
uuidd:*:17379:0:99999:7:::
lightdm:*:17379:0:99999:7:::
whoopsie:*:17379:0:99999:7:::
avahi-autoipd:*:17379:0:99999:7:::
avahi:*:17379:0:99999:7:::
dnsmasq:*:17379:0:99999:7:::
colord:*:17379:0:99999:7:::
speech-dispatcher:!:17379:0:99999:7:::
hplip:*:17379:0:99999:7:::
kernoops:*:17379:0:99999:7:::
pulse:*:17379:0:99999:7:::
rtkit:*:17379:0:99999:7:::
saned:*:17379:0:99999:7:::
usbmux:*:17379:0:99999:7:::
marlinspike:$6$wQb5nV3T$xB2WO/jOkbn4t1RUILrckw69LR/0EMtUbFFCYpM3MUHVmtyYW9.ov/aszTpWhLaC2x6Fvy5tpUUxQbUhCKbl4/:17484:0:99999:7:::
mysql:!:17486:0:99999:7:::
sshd:*:17486:0:99999:7:::
═╣ Can I read shadow plists? ............ No
═╣ Can I write shadow plists? ........... No
═╣ Can I read opasswd file? ............. No
═╣ Can I write in network-scripts? ...... No
═╣ Can I read root folder? .............. No

╔══════════╣ Searching root files in home dirs (limit 30)
/home/
/home/marlinspike/proftpd-1.3.3c/ftpshut
/home/marlinspike/proftpd-1.3.3c/ftpscrub
/home/marlinspike/proftpd-1.3.3c/locale/Makefile
/home/marlinspike/proftpd-1.3.3c/libtool
/home/marlinspike/proftpd-1.3.3c/src/data.o
/home/marlinspike/proftpd-1.3.3c/src/proctitle.o
/home/marlinspike/proftpd-1.3.3c/src/session.o
/home/marlinspike/proftpd-1.3.3c/src/pool.o
/home/marlinspike/proftpd-1.3.3c/src/timers.o
/home/marlinspike/proftpd-1.3.3c/src/wtmp.o
/home/marlinspike/proftpd-1.3.3c/src/modules.o
/home/marlinspike/proftpd-1.3.3c/src/expr.o
/home/marlinspike/proftpd-1.3.3c/src/version.o
/home/marlinspike/proftpd-1.3.3c/src/var.o
/home/marlinspike/proftpd-1.3.3c/src/help.o
/home/marlinspike/proftpd-1.3.3c/src/scoreboard.o
/home/marlinspike/proftpd-1.3.3c/src/fsio.o
/home/marlinspike/proftpd-1.3.3c/src/filter.o
/home/marlinspike/proftpd-1.3.3c/src/lastlog.o
/home/marlinspike/proftpd-1.3.3c/src/netacl.o
/home/marlinspike/proftpd-1.3.3c/src/child.o
/home/marlinspike/proftpd-1.3.3c/src/Makefile
/home/marlinspike/proftpd-1.3.3c/src/main.o
/home/marlinspike/proftpd-1.3.3c/src/bindings.o
/home/marlinspike/proftpd-1.3.3c/src/xferlog.5
/home/marlinspike/proftpd-1.3.3c/src/log.o
/home/marlinspike/proftpd-1.3.3c/src/table.o
/home/marlinspike/proftpd-1.3.3c/src/pidfile.o
/home/marlinspike/proftpd-1.3.3c/src/trace.o

╔══════════╣ Searching folders owned by me containing others files on it (limit 100)
/var/www/html

╔══════════╣ Readable files belonging to root and readable by me but not world readable

╔══════════╣ Modified interesting files in the last 5mins (limit 100)
/var/tmp/www/lin-out.txt
/var/log/auth.log
/var/log/syslog

╔══════════╣ Writable log files (logrotten) (limit 100)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation

╔══════════╣ Files inside /home/www-data (limit 20)

╔══════════╣ Files inside others home (limit 20)
/home/marlinspike/.bash_history
/home/marlinspike/.bashrc
/home/marlinspike/046e85f6fe460de94fd46198feef4d07-backdoored_proftpd-1.3.3c.tar.gz
/home/marlinspike/.mysql_history
/home/marlinspike/Downloads/046e85f6fe460de94fd46198feef4d07-backdoored_proftpd-1.3.3c.tar.gz
/home/marlinspike/.ICEauthority
/home/marlinspike/proftpd-1.3.3c.tar.bz2
/home/marlinspike/wordpress/wp-mail.php
/home/marlinspike/wordpress/index.php
/home/marlinspike/wordpress/wp-cron.php
/home/marlinspike/wordpress/xmlrpc.php
/home/marlinspike/wordpress/wp-activate.php
/home/marlinspike/wordpress/wp-blog-header.php
/home/marlinspike/wordpress/wp-content/index.php
/home/marlinspike/wordpress/wp-content/themes/index.php
/home/marlinspike/wordpress/wp-content/themes/twentyseventeen/404.php
/home/marlinspike/wordpress/wp-content/themes/twentyseventeen/index.php
/home/marlinspike/wordpress/wp-content/themes/twentyseventeen/search.php
/home/marlinspike/wordpress/wp-content/themes/twentyseventeen/header.php
/home/marlinspike/wordpress/wp-content/themes/twentyseventeen/archive.php
grep: write error: Broken pipe

╔══════════╣ Searching installed mail applications

╔══════════╣ Mails (limit 50)

╔══════════╣ Backup folders

╔══════════╣ Backup files (limited 100)
-rw-r--r-- 1 root root 0 Apr 13  2021 /usr/src/linux-headers-4.15.0-142-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Apr 13  2021 /usr/src/linux-headers-4.15.0-142-generic/include/config/net/team/mode/activebackup.h
-rw-r--r-- 1 root root 217418 Apr 13  2021 /usr/src/linux-headers-4.15.0-142-generic/.config.old
-rw-r--r-- 1 root root 0 Jul 20  2017 /usr/src/linux-headers-4.10.0-28-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Jul 20  2017 /usr/src/linux-headers-4.10.0-28-generic/include/config/net/team/mode/activebackup.h
-rw-r--r-- 1 root root 204981 Jul 20  2017 /usr/src/linux-headers-4.10.0-28-generic/.config.old
-rw-r--r-- 1 root root 5406 Oct 18  2016 /usr/lib/libreoffice/share/config/soffice.cfg/dbaccess/ui/backuppage.ui
-rw-r--r-- 1 root root 298768 Dec 29  2015 /usr/share/doc/manpages/Changes.old.gz
-rwxr-xr-x 1 root root 1513 Oct 19  2013 /usr/share/doc/libipc-system-simple-perl/examples/rsync-backup.pl
-rw-r--r-- 1 root root 7867 May  6  2015 /usr/share/doc/telnet/README.telnet.old.gz
-rw-r--r-- 1 root root 1989 Jun 21  2016 /usr/share/help/C/ubuntu-help/backup-frequency.page
-rw-r--r-- 1 root root 2498 Jun 21  2016 /usr/share/help/C/ubuntu-help/backup-what.page
-rw-r--r-- 1 root root 2266 Jun 21  2016 /usr/share/help/C/ubuntu-help/backup-where.page
-rw-r--r-- 1 root root 2374 Jun 21  2016 /usr/share/help/C/ubuntu-help/backup-how.page
-rw-r--r-- 1 root root 1254 Jun 21  2016 /usr/share/help/C/ubuntu-help/backup-why.page
-rw-r--r-- 1 root root 3050 Jun 21  2016 /usr/share/help/C/ubuntu-help/backup-thinkabout.page
-rw-r--r-- 1 root root 1687 Jun 21  2016 /usr/share/help/C/ubuntu-help/backup-check.page
-rw-r--r-- 1 root root 1383 Jun 21  2016 /usr/share/help/C/ubuntu-help/backup-restore.page
-rw-r--r-- 1 root root 969 Oct 10  2013 /usr/share/help/C/deja-dup/backup-auto.page
-rw-r--r-- 1 root root 750 Oct 16  2013 /usr/share/help/C/deja-dup/backup-first.page
-rw-r--r-- 1 root root 1581 Oct 27  2015 /usr/share/help/C/seahorse/misc-key-backup.page
-rw-r--r-- 1 root root 1999 Oct 23  2015 /usr/share/help/C/gnome-help/backup-frequency.page
-rw-r--r-- 1 root root 2505 Oct 23  2015 /usr/share/help/C/gnome-help/backup-what.page
-rw-r--r-- 1 root root 2264 Oct 23  2015 /usr/share/help/C/gnome-help/backup-where.page
-rw-r--r-- 1 root root 2356 Oct 23  2015 /usr/share/help/C/gnome-help/backup-how.page
-rw-r--r-- 1 root root 1262 Oct 23  2015 /usr/share/help/C/gnome-help/backup-why.page
-rw-r--r-- 1 root root 3363 Oct 23  2015 /usr/share/help/C/gnome-help/backup-thinkabout.page
-rw-r--r-- 1 root root 1813 Oct 23  2015 /usr/share/help/C/gnome-help/backup-check.page
-rw-r--r-- 1 root root 1320 Oct 23  2015 /usr/share/help/C/gnome-help/backup-restore.page
-rw-r--r-- 1 root root 2018 Jun 21  2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-frequency.page
-rw-r--r-- 1 root root 2500 Jun 21  2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-what.page
-rw-r--r-- 1 root root 2295 Jun 21  2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-where.page
-rw-r--r-- 1 root root 2392 Jun 21  2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-how.page
-rw-r--r-- 1 root root 1291 Jun 21  2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-why.page
-rw-r--r-- 1 root root 3073 Jun 21  2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-thinkabout.page
-rw-r--r-- 1 root root 1720 Jun 21  2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-check.page
-rw-r--r-- 1 root root 1422 Jun 21  2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-restore.page
-rw-r--r-- 1 root root 974 Apr  7  2016 /usr/share/help-langpack/en_AU/deja-dup/backup-auto.page
-rw-r--r-- 1 root root 755 Apr  7  2016 /usr/share/help-langpack/en_AU/deja-dup/backup-first.page
-rw-r--r-- 1 root root 2034 Jun 21  2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-frequency.page
-rw-r--r-- 1 root root 2530 Jun 21  2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-what.page
-rw-r--r-- 1 root root 2308 Jun 21  2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-where.page
-rw-r--r-- 1 root root 2418 Jun 21  2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-how.page
-rw-r--r-- 1 root root 1298 Jun 21  2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-why.page
-rw-r--r-- 1 root root 3094 Jun 21  2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-thinkabout.page
-rw-r--r-- 1 root root 1732 Jun 21  2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-check.page
-rw-r--r-- 1 root root 1427 Jun 21  2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-restore.page
-rw-r--r-- 1 root root 2020 Jun 21  2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-frequency.page
-rw-r--r-- 1 root root 2503 Jun 21  2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-what.page
-rw-r--r-- 1 root root 2289 Jun 21  2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-where.page
-rw-r--r-- 1 root root 2371 Jun 21  2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-how.page
-rw-r--r-- 1 root root 1291 Jun 21  2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-why.page
-rw-r--r-- 1 root root 3067 Jun 21  2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-thinkabout.page
-rw-r--r-- 1 root root 1720 Jun 21  2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-check.page
-rw-r--r-- 1 root root 1420 Jun 21  2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-restore.page
-rw-r--r-- 1 root root 974 Apr  7  2016 /usr/share/help-langpack/en_GB/deja-dup/backup-auto.page
-rw-r--r-- 1 root root 755 Apr  7  2016 /usr/share/help-langpack/en_GB/deja-dup/backup-first.page
-rw-r--r-- 1 root root 2543 Jun 24  2016 /usr/share/help-langpack/en_GB/evolution/backup-restore.page
-rw-r--r-- 1 root root 76 Mar 31  2017 /usr/share/lightdm/lightdm.conf.d/50-disable-log-backup.conf
-rw-r--r-- 1 root root 502 Sep 10  2015 /usr/share/app-install/desktop/slbackup-php:slbackup-php.desktop
-rw-r--r-- 1 root root 446 Sep 10  2015 /usr/share/app-install/desktop/kbackup:kde4__kbackup.desktop
-rw-r--r-- 1 root root 396 Sep 10  2015 /usr/share/app-install/desktop/barrybackup-gui:barrybackup.desktop
-rw-r--r-- 1 root root 449 Sep 10  2015 /usr/share/app-install/desktop/luckybackup:luckybackup.desktop
-rw-r--r-- 1 root root 14532 Jan 19 07:19 /usr/share/info/dir.old
-rw-r--r-- 1 root root 673 Aug  1  2017 /etc/xml/xml-core.xml.old
-rw-r--r-- 1 root root 610 Aug  1  2017 /etc/xml/catalog.old
-rw-r--r-- 1 root root 8094 Apr 13  2021 /lib/modules/4.15.0-142-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rw-r--r-- 1 root root 8150 Apr 13  2021 /lib/modules/4.15.0-142-generic/kernel/drivers/net/team/team_mode_activebackup.ko
-rw-r--r-- 1 root root 7830 Jul 20  2017 /lib/modules/4.10.0-28-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rw-r--r-- 1 root root 7814 Jul 20  2017 /lib/modules/4.10.0-28-generic/kernel/drivers/net/team/team_mode_activebackup.ko
-rw-r--r-- 1 root root 292 Jan 19 07:21 /run/blkid/blkid.tab.old
-rw-r--r-- 1 root root 128 Aug  1  2017 /var/lib/sgml-base/supercatalog.old
-rw-r--r-- 1 root root 31662 Nov 17  2017 /var/log/Xorg.0.log.old
-rw-rw-r-- 1 marlinspike marlinspike 4166609 Nov 16  2017 /home/marlinspike/proftpd-1.3.3c.tar.bz2.bak
-rw-rw-r-- 1 marlinspike marlinspike 4929934 Nov 17  2017 /home/marlinspike/046e85f6fe460de94fd46198feef4d07-backdoored_proftpd-1.3.3c.tar.gz.bak

╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)
Found: /var/lib/colord/mapping.db: SQLite 3.x database
Found: /var/lib/colord/storage.db: SQLite 3.x database
Found: /var/lib/fwupd/pending.db: SQLite 3.x database
Found: /var/lib/mlocate/mlocate.db: regular file, no read permission
Found: /var/lib/nssdb/cert9.db: SQLite 3.x database
Found: /var/lib/nssdb/key4.db: SQLite 3.x database
Found: /var/lib/nssdb/secmod.db: Berkeley DB 1.85 (Hash, version 2, native byte-order)

 -> Extracting tables from /var/lib/colord/mapping.db (limit 20)


 -> Extracting tables from /var/lib/colord/storage.db (limit 20)



 -> Extracting tables from /var/lib/fwupd/pending.db (limit 20)

 -> Extracting tables from /var/lib/nssdb/cert9.db (limit 20)

 -> Extracting tables from /var/lib/nssdb/key4.db (limit 20)



╔══════════╣ Web files?(output limit)
/var/www/:
total 12K
drwxr-xr-x  3 root     root     4.0K Nov 16  2017 .
drwxr-xr-x 15 root     root     4.0K Nov 16  2017 ..
drwxr-xr-x  3 www-data www-data 4.0K Nov 16  2017 html

/var/www/html:
total 20K
drwxr-xr-x 3 www-data www-data 4.0K Nov 16  2017 .
drwxr-xr-x 3 root     root     4.0K Nov 16  2017 ..

╔══════════╣ All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw------- 1 root root 0 Aug  1  2017 /etc/.pwd.lock
-rw-r--r-- 1 root root 1492 Jan 19 07:19 /etc/apparmor.d/cache/.features
-rw-r--r-- 1 root root 220 Aug 31  2015 /etc/skel/.bash_logout
-rw-r--r-- 1 root root 0 Jan 18 15:44 /run/network/.ifstate.lock
-r--r--r-- 1 root root 11 Jan 18 15:44 /tmp/.X0-lock
-rw-r--r-- 1 www-data www-data 249 Nov 16  2017 /var/www/html/secret/.htaccess
-rw-r--r-- 1 www-data www-data 629 May  9  2016 /var/www/html/secret/wp-content/plugins/akismet/.htaccess
-rw-r--r-- 1 www-data www-data 235 Nov 16  2017 /var/www/html/.htaccess
-rw------- 1 marlinspike marlinspike 2926 Nov 17  2017 /home/marlinspike/.ICEauthority
-rw-r--r-- 1 marlinspike marlinspike 629 May  9  2016 /home/marlinspike/wordpress/wp-content/plugins/akismet/.htaccess
-rw-r--r-- 1 marlinspike marlinspike 155 Dec 31  2004 /home/marlinspike/proftpd-1.3.3c/.autom4te.cfg
-rw------- 1 marlinspike marlinspike 1171 Nov 17  2017 /home/marlinspike/.xsession-errors.old
-rw------- 1 marlinspike marlinspike 118 Nov 17  2017 /home/marlinspike/.Xauthority
-rw-r--r-- 1 marlinspike marlinspike 155 Dec 31  2004 /home/marlinspike/backdoored_proftpd-1.3.3c/.autom4te.cfg
-rw-r--r-- 1 marlinspike marlinspike 220 Nov 14  2017 /home/marlinspike/.bash_logout
-rw-r--r-- 1 marlinspike marlinspike 25 Nov 14  2017 /home/marlinspike/.dmrc
-rw------- 1 marlinspike marlinspike 1175 Nov 17  2017 /home/marlinspike/.xsession-errors

╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)
-r--r--r-- 1 root root 11 Jan 18 15:44 /tmp/.X0-lock
-rwxrwxrwx 1 www-data www-data 761415 Jan 20 05:26 /var/tmp/www/li.sh
-rw-rw-rw- 1 www-data www-data 158010 Jan 20 05:59 /var/tmp/www/lin-out.txt
-rw-rw-rw- 1 www-data www-data 1412 Jan 20 05:48 /var/tmp/www/linpeas.sh
-rw-rw-rw- 1 www-data www-data 196937 Jan 20 05:53 /var/tmp/www/li.txt
-rw-r--r-- 1 root root 1044 Nov 14  2017 /var/backups/dpkg.diversions.0
-rw-r--r-- 1 root root 345 Nov 14  2017 /var/backups/dpkg.diversions.3.gz
-rw-r--r-- 1 root root 469809 Nov 14  2017 /var/backups/dpkg.status.3.gz
-rw-r--r-- 1 root root 4049 Jan 19 07:21 /var/backups/apt.extended_states.0
-rw-r--r-- 1 root root 485500 Nov 16  2017 /var/backups/dpkg.status.1.gz
-rw-r--r-- 1 root root 345 Nov 14  2017 /var/backups/dpkg.diversions.2.gz
-rw-r--r-- 1 root root 3626 Nov 14  2017 /var/backups/alternatives.tar.2.gz
-rw-r--r-- 1 root root 11 Nov 14  2017 /var/backups/dpkg.arch.0
-rw-r--r-- 1 root root 265 Nov 16  2017 /var/backups/dpkg.statoverride.0
-rw-r--r-- 1 root root 71680 Jan 19 07:35 /var/backups/alternatives.tar.0
-rw-r--r-- 1 root root 195 Nov 16  2017 /var/backups/dpkg.statoverride.1.gz
-rw-r--r-- 1 root root 1785391 Jan 19 07:21 /var/backups/dpkg.status.0
-rw-r--r-- 1 root root 408 Nov 16  2017 /var/backups/apt.extended_states.2.gz
-rw-r--r-- 1 root root 179 Aug  1  2017 /var/backups/dpkg.statoverride.3.gz
-rw-r--r-- 1 root root 365 Nov 14  2017 /var/backups/apt.extended_states.3.gz
-rw-r--r-- 1 root root 43 Nov 14  2017 /var/backups/dpkg.arch.2.gz
-rw-r--r-- 1 root root 345 Nov 14  2017 /var/backups/dpkg.diversions.1.gz
-rw-r--r-- 1 root root 3885 Nov 16  2017 /var/backups/alternatives.tar.1.gz
-rw-r--r-- 1 root root 43 Nov 14  2017 /var/backups/dpkg.arch.3.gz
-rw-r--r-- 1 root root 483992 Nov 16  2017 /var/backups/dpkg.status.2.gz
-rw-r--r-- 1 root root 531 Nov 16  2017 /var/backups/apt.extended_states.1.gz
-rw-r--r-- 1 root root 195 Nov 16  2017 /var/backups/dpkg.statoverride.2.gz
-rw-r--r-- 1 root root 43 Nov 14  2017 /var/backups/dpkg.arch.1.gz

╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files
awk: write failure (Broken pipe)
awk: close failed on file /dev/stdout (Broken pipe)
uniq: write error: Broken pipe
/dev/mqueue
/dev/shm
/etc/passwd
/run/lock
/run/lock/apache2
/tmp
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/.X11-unix
/tmp/.XIM-unix
/tmp/.font-unix
/var/cache/apache2/mod_cache_disk
/var/crash
/var/lib/php/sessions
/var/metrics
/var/tmp
/var/tmp/www
/var/tmp/www/li.sh
/var/tmp/www/li.txt
/var/tmp/www/lin-out.txt
/var/tmp/www/linpeas.sh
/var/www/html
/var/www/html/.htaccess
/var/www/html/secret
/var/www/html/secret/.htaccess
/var/www/html/secret/index.php
/var/www/html/secret/license.txt
/var/www/html/secret/readme.html
/var/www/html/secret/wp-activate.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/about.php
/var/www/html/secret/wp-admin/admin-ajax.php
/var/www/html/secret/wp-admin/admin-footer.php
/var/www/html/secret/wp-admin/admin-functions.php
/var/www/html/secret/wp-admin/admin-header.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/css/about-rtl.css
/var/www/html/secret/wp-admin/css/about-rtl.min.css
/var/www/html/secret/wp-admin/css/about.css
/var/www/html/secret/wp-admin/css/about.min.css
/var/www/html/secret/wp-admin/css/admin-menu-rtl.css
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/css/colors/_admin.scss
/var/www/html/secret/wp-admin/css/colors/_mixins.scss
/var/www/html/secret/wp-admin/css/colors/_variables.scss
/var/www/html/secret/wp-admin/css/colors/blue
/var/www/html/secret/wp-admin/css/colors/blue/colors-rtl.css
/var/www/html/secret/wp-admin/css/colors/blue/colors-rtl.min.css
/var/www/html/secret/wp-admin/css/colors/blue/colors.css
/var/www/html/secret/wp-admin/css/colors/blue/colors.min.css
/var/www/html/secret/wp-admin/css/colors/blue/colors.scss
/var/www/html/secret/wp-admin/css/colors/coffee
/var/www/html/secret/wp-admin/css/colors/coffee/colors-rtl.css
/var/www/html/secret/wp-admin/css/colors/coffee/colors-rtl.min.css
/var/www/html/secret/wp-admin/css/colors/coffee/colors.css
/var/www/html/secret/wp-admin/css/colors/coffee/colors.min.css
/var/www/html/secret/wp-admin/css/colors/coffee/colors.scss
/var/www/html/secret/wp-admin/css/colors/ectoplasm
/var/www/html/secret/wp-admin/css/colors/ectoplasm/colors-rtl.css
/var/www/html/secret/wp-admin/css/colors/ectoplasm/colors-rtl.min.css
/var/www/html/secret/wp-admin/css/colors/ectoplasm/colors.css
/var/www/html/secret/wp-admin/css/colors/ectoplasm/colors.min.css
/var/www/html/secret/wp-admin/css/colors/ectoplasm/colors.scss
/var/www/html/secret/wp-admin/css/colors/light
/var/www/html/secret/wp-admin/css/colors/light/colors-rtl.css
/var/www/html/secret/wp-admin/css/colors/light/colors-rtl.min.css
/var/www/html/secret/wp-admin/css/colors/light/colors.css
/var/www/html/secret/wp-admin/css/colors/light/colors.min.css
/var/www/html/secret/wp-admin/css/colors/light/colors.scss
/var/www/html/secret/wp-admin/css/colors/midnight
/var/www/html/secret/wp-admin/css/colors/midnight/colors-rtl.css
/var/www/html/secret/wp-admin/css/colors/midnight/colors-rtl.min.css
/var/www/html/secret/wp-admin/css/colors/midnight/colors.css
/var/www/html/secret/wp-admin/css/colors/midnight/colors.min.css
/var/www/html/secret/wp-admin/css/colors/midnight/colors.scss
/var/www/html/secret/wp-admin/css/colors/ocean
/var/www/html/secret/wp-admin/css/colors/ocean/colors-rtl.css
/var/www/html/secret/wp-admin/css/colors/ocean/colors-rtl.min.css
/var/www/html/secret/wp-admin/css/colors/ocean/colors.css
/var/www/html/secret/wp-admin/css/colors/ocean/colors.min.css
/var/www/html/secret/wp-admin/css/colors/ocean/colors.scss
/var/www/html/secret/wp-admin/css/colors/sunrise
/var/www/html/secret/wp-admin/css/colors/sunrise/colors-rtl.css
/var/www/html/secret/wp-admin/css/colors/sunrise/colors-rtl.min.css
/var/www/html/secret/wp-admin/css/colors/sunrise/colors.css
/var/www/html/secret/wp-admin/css/colors/sunrise/colors.min.css
/var/www/html/secret/wp-admin/css/colors/sunrise/colors.scss
/var/www/html/secret/wp-admin/css/common-rtl.css
/var/www/html/secret/wp-admin/css/common-rtl.min.css
/var/www/html/secret/wp-admin/css/common.css
/var/www/html/secret/wp-admin/css/common.min.css
/var/www/html/secret/wp-admin/css/customize-controls-rtl.css
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/custom-background.php
/var/www/html/secret/wp-admin/custom-header.php
/var/www/html/secret/wp-admin/customize.php
/var/www/html/secret/wp-admin/edit-comments.php
/var/www/html/secret/wp-admin/edit-form-advanced.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/includes/admin-filters.php
/var/www/html/secret/wp-admin/includes/admin.php
/var/www/html/secret/wp-admin/includes/ajax-actions.php
/var/www/html/secret/wp-admin/includes/bookmark.php
/var/www/html/secret/wp-admin/includes/class-automatic-upgrader-skin.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/index.php
/var/www/html/secret/wp-admin/install-helper.php
/var/www/html/secret/wp-admin/install.php
/var/www/html/secret/wp-admin/js
/var/www/html/secret/wp-admin/js/accordion.js
/var/www/html/secret/wp-admin/js/accordion.min.js
/var/www/html/secret/wp-admin/js/code-editor.js
/var/www/html/secret/wp-admin/js/code-editor.min.js
/var/www/html/secret/wp-admin/js/color-picker.js
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/js/widgets/custom-html-widgets.js
/var/www/html/secret/wp-admin/js/widgets/custom-html-widgets.min.js
/var/www/html/secret/wp-admin/js/widgets/media-audio-widget.js
/var/www/html/secret/wp-admin/js/widgets/media-audio-widget.min.js
/var/www/html/secret/wp-admin/js/widgets/media-gallery-widget.js
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/js/word-count.js
/var/www/html/secret/wp-admin/js/word-count.min.js
/var/www/html/secret/wp-admin/js/wp-fullscreen-stub.js
/var/www/html/secret/wp-admin/js/wp-fullscreen-stub.min.js
/var/www/html/secret/wp-admin/js/xfn.js
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/link-add.php
/var/www/html/secret/wp-admin/link-manager.php
/var/www/html/secret/wp-admin/link-parse-opml.php
/var/www/html/secret/wp-admin/link.php
/var/www/html/secret/wp-admin/load-scripts.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/maint/repair.php
/var/www/html/secret/wp-admin/media-new.php
/var/www/html/secret/wp-admin/media-upload.php
/var/www/html/secret/wp-admin/media.php
/var/www/html/secret/wp-admin/menu-header.php
/var/www/html/secret/wp-admin/menu.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/network/about.php
/var/www/html/secret/wp-admin/network/admin.php
/var/www/html/secret/wp-admin/network/credits.php
/var/www/html/secret/wp-admin/network/edit.php
/var/www/html/secret/wp-admin/network/freedoms.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/options-discussion.php
/var/www/html/secret/wp-admin/options-general.php
/var/www/html/secret/wp-admin/options-head.php
/var/www/html/secret/wp-admin/options-media.php
/var/www/html/secret/wp-admin/options-permalink.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/user/about.php
/var/www/html/secret/wp-admin/user/admin.php
/var/www/html/secret/wp-admin/user/credits.php
/var/www/html/secret/wp-admin/user/freedoms.php
/var/www/html/secret/wp-admin/user/index.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-admin/users.php
/var/www/html/secret/wp-admin/widgets.php
/var/www/html/secret/wp-blog-header.php
/var/www/html/secret/wp-comments-post.php
/var/www/html/secret/wp-config.php
/var/www/html/secret/wp-content
/var/www/html/secret/wp-content/index.php
/var/www/html/secret/wp-content/plugins
/var/www/html/secret/wp-content/plugins/akismet
/var/www/html/secret/wp-content/plugins/akismet/.htaccess
/var/www/html/secret/wp-content/plugins/akismet/LICENSE.txt
/var/www/html/secret/wp-content/plugins/akismet/_inc
/var/www/html/secret/wp-content/plugins/akismet/_inc/akismet.css
/var/www/html/secret/wp-content/plugins/akismet/_inc/akismet.js
/var/www/html/secret/wp-content/plugins/akismet/_inc/form.js
/var/www/html/secret/wp-content/plugins/akismet/_inc/img
/var/www/html/secret/wp-content/plugins/akismet/akismet.php
/var/www/html/secret/wp-content/plugins/akismet/class.akismet-admin.php
/var/www/html/secret/wp-content/plugins/akismet/class.akismet-cli.php
/var/www/html/secret/wp-content/plugins/akismet/class.akismet-rest-api.php
/var/www/html/secret/wp-content/plugins/akismet/class.akismet-widget.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/plugins/akismet/views/config.php
/var/www/html/secret/wp-content/plugins/akismet/views/get.php
/var/www/html/secret/wp-content/plugins/akismet/views/notice.php
/var/www/html/secret/wp-content/plugins/akismet/views/start.php
/var/www/html/secret/wp-content/plugins/akismet/views/stats.php
/var/www/html/secret/wp-content/plugins/akismet/wrapper.php
/var/www/html/secret/wp-content/plugins/hello.php
/var/www/html/secret/wp-content/plugins/index.php
/var/www/html/secret/wp-content/themes
/var/www/html/secret/wp-content/themes/index.php
/var/www/html/secret/wp-content/themes/twentyfifteen
/var/www/html/secret/wp-content/themes/twentyfifteen/404.php
/var/www/html/secret/wp-content/themes/twentyfifteen/archive.php
/var/www/html/secret/wp-content/themes/twentyfifteen/author-bio.php
/var/www/html/secret/wp-content/themes/twentyfifteen/comments.php
/var/www/html/secret/wp-content/themes/twentyfifteen/content-link.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentyfifteen/css/editor-style.css
/var/www/html/secret/wp-content/themes/twentyfifteen/css/ie.css
/var/www/html/secret/wp-content/themes/twentyfifteen/css/ie7.css
/var/www/html/secret/wp-content/themes/twentyfifteen/footer.php
/var/www/html/secret/wp-content/themes/twentyfifteen/functions.php
/var/www/html/secret/wp-content/themes/twentyfifteen/genericons
/var/www/html/secret/wp-content/themes/twentyfifteen/genericons/COPYING.txt
/var/www/html/secret/wp-content/themes/twentyfifteen/genericons/Genericons.eot
/var/www/html/secret/wp-content/themes/twentyfifteen/genericons/Genericons.ttf
/var/www/html/secret/wp-content/themes/twentyfifteen/genericons/Genericons.woff
/var/www/html/secret/wp-content/themes/twentyfifteen/genericons/LICENSE.txt
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentyfifteen/header.php
/var/www/html/secret/wp-content/themes/twentyfifteen/image.php
/var/www/html/secret/wp-content/themes/twentyfifteen/inc
/var/www/html/secret/wp-content/themes/twentyfifteen/inc/back-compat.php
/var/www/html/secret/wp-content/themes/twentyfifteen/inc/custom-header.php
/var/www/html/secret/wp-content/themes/twentyfifteen/inc/customizer.php
/var/www/html/secret/wp-content/themes/twentyfifteen/inc/template-tags.php
/var/www/html/secret/wp-content/themes/twentyfifteen/index.php
/var/www/html/secret/wp-content/themes/twentyfifteen/js
/var/www/html/secret/wp-content/themes/twentyfifteen/js/color-scheme-control.js
/var/www/html/secret/wp-content/themes/twentyfifteen/js/customize-preview.js
/var/www/html/secret/wp-content/themes/twentyfifteen/js/functions.js
/var/www/html/secret/wp-content/themes/twentyfifteen/js/html5.js
/var/www/html/secret/wp-content/themes/twentyfifteen/js/keyboard-image-navigation.js
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentyfifteen/page.php
/var/www/html/secret/wp-content/themes/twentyfifteen/readme.txt
/var/www/html/secret/wp-content/themes/twentyfifteen/rtl.css
/var/www/html/secret/wp-content/themes/twentyfifteen/search.php
/var/www/html/secret/wp-content/themes/twentyfifteen/sidebar.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentyseventeen
/var/www/html/secret/wp-content/themes/twentyseventeen/404.php
/var/www/html/secret/wp-content/themes/twentyseventeen/README.txt
/var/www/html/secret/wp-content/themes/twentyseventeen/archive.php
/var/www/html/secret/wp-content/themes/twentyseventeen/assets
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/css
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/css/colors-dark.css
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/css/editor-style.css
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/css/ie8.css
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/css/ie9.css
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/images
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/js
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/js/customize-controls.js
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/js/customize-preview.js
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/js/global.js
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/js/html5.js
/var/www/html/secret/wp-content/themes/twentyseventeen/assets/js/jquery.scrollTo.js
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentyseventeen/comments.php
/var/www/html/secret/wp-content/themes/twentyseventeen/footer.php
/var/www/html/secret/wp-content/themes/twentyseventeen/front-page.php
/var/www/html/secret/wp-content/themes/twentyseventeen/functions.php
/var/www/html/secret/wp-content/themes/twentyseventeen/header.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentyseventeen/inc/back-compat.php
/var/www/html/secret/wp-content/themes/twentyseventeen/inc/color-patterns.php
/var/www/html/secret/wp-content/themes/twentyseventeen/inc/custom-header.php
/var/www/html/secret/wp-content/themes/twentyseventeen/inc/customizer.php
/var/www/html/secret/wp-content/themes/twentyseventeen/inc/icon-functions.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentyseventeen/index.php
/var/www/html/secret/wp-content/themes/twentyseventeen/page.php
/var/www/html/secret/wp-content/themes/twentyseventeen/rtl.css
/var/www/html/secret/wp-content/themes/twentyseventeen/search.php
/var/www/html/secret/wp-content/themes/twentyseventeen/searchform.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/footer
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/footer/footer-widgets.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/footer/site-info.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/header
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/header/header-image.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/header/site-branding.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/navigation
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/navigation/navigation-top.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/page
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/page/content-front-page-panels.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/page/content-front-page.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/page/content-page.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/post
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/post/content-audio.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/post/content-excerpt.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/post/content-gallery.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/post/content-image.php
/var/www/html/secret/wp-content/themes/twentyseventeen/template-parts/post/content-none.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentysixteen
/var/www/html/secret/wp-content/themes/twentysixteen/404.php
/var/www/html/secret/wp-content/themes/twentysixteen/archive.php
/var/www/html/secret/wp-content/themes/twentysixteen/comments.php
/var/www/html/secret/wp-content/themes/twentysixteen/css
/var/www/html/secret/wp-content/themes/twentysixteen/css/editor-style.css
/var/www/html/secret/wp-content/themes/twentysixteen/css/ie.css
/var/www/html/secret/wp-content/themes/twentysixteen/css/ie7.css
/var/www/html/secret/wp-content/themes/twentysixteen/css/ie8.css
/var/www/html/secret/wp-content/themes/twentysixteen/footer.php
/var/www/html/secret/wp-content/themes/twentysixteen/functions.php
/var/www/html/secret/wp-content/themes/twentysixteen/genericons
/var/www/html/secret/wp-content/themes/twentysixteen/genericons/COPYING.txt
/var/www/html/secret/wp-content/themes/twentysixteen/genericons/Genericons.eot
/var/www/html/secret/wp-content/themes/twentysixteen/genericons/Genericons.ttf
/var/www/html/secret/wp-content/themes/twentysixteen/genericons/Genericons.woff
/var/www/html/secret/wp-content/themes/twentysixteen/genericons/LICENSE.txt
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentysixteen/header.php
/var/www/html/secret/wp-content/themes/twentysixteen/image.php
/var/www/html/secret/wp-content/themes/twentysixteen/inc
/var/www/html/secret/wp-content/themes/twentysixteen/inc/back-compat.php
/var/www/html/secret/wp-content/themes/twentysixteen/inc/customizer.php
/var/www/html/secret/wp-content/themes/twentysixteen/inc/template-tags.php
/var/www/html/secret/wp-content/themes/twentysixteen/index.php
/var/www/html/secret/wp-content/themes/twentysixteen/js
/var/www/html/secret/wp-content/themes/twentysixteen/js/color-scheme-control.js
/var/www/html/secret/wp-content/themes/twentysixteen/js/customize-preview.js
/var/www/html/secret/wp-content/themes/twentysixteen/js/functions.js
/var/www/html/secret/wp-content/themes/twentysixteen/js/html5.js
/var/www/html/secret/wp-content/themes/twentysixteen/js/keyboard-image-navigation.js
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentysixteen/page.php
/var/www/html/secret/wp-content/themes/twentysixteen/readme.txt
/var/www/html/secret/wp-content/themes/twentysixteen/rtl.css
/var/www/html/secret/wp-content/themes/twentysixteen/search.php
/var/www/html/secret/wp-content/themes/twentysixteen/searchform.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/themes/twentysixteen/template-parts/biography.php
/var/www/html/secret/wp-content/themes/twentysixteen/template-parts/content-none.php
/var/www/html/secret/wp-content/themes/twentysixteen/template-parts/content-page.php
/var/www/html/secret/wp-content/themes/twentysixteen/template-parts/content-search.php
/var/www/html/secret/wp-content/themes/twentysixteen/template-parts/content-single.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-content/upgrade
/var/www/html/secret/wp-content/uploads
/var/www/html/secret/wp-content/uploads/2022
/var/www/html/secret/wp-content/uploads/2022/01
/var/www/html/secret/wp-cron.php
/var/www/html/secret/wp-includes
/var/www/html/secret/wp-includes/ID3
/var/www/html/secret/wp-includes/ID3/getid3.lib.php
/var/www/html/secret/wp-includes/ID3/getid3.php
/var/www/html/secret/wp-includes/ID3/license.commercial.txt
/var/www/html/secret/wp-includes/ID3/license.txt
/var/www/html/secret/wp-includes/ID3/module.audio-video.asf.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-includes/IXR
/var/www/html/secret/wp-includes/IXR/class-IXR-base64.php
/var/www/html/secret/wp-includes/IXR/class-IXR-client.php
/var/www/html/secret/wp-includes/IXR/class-IXR-clientmulticall.php
/var/www/html/secret/wp-includes/IXR/class-IXR-date.php
/var/www/html/secret/wp-includes/IXR/class-IXR-error.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-includes/Requests
/var/www/html/secret/wp-includes/Requests/Auth
/var/www/html/secret/wp-includes/Requests/Auth.php
/var/www/html/secret/wp-includes/Requests/Auth/Basic.php
/var/www/html/secret/wp-includes/Requests/Cookie
/var/www/html/secret/wp-includes/Requests/Cookie.php
/var/www/html/secret/wp-includes/Requests/Cookie/Jar.php
/var/www/html/secret/wp-includes/Requests/Exception
/var/www/html/secret/wp-includes/Requests/Exception.php
/var/www/html/secret/wp-includes/Requests/Exception/HTTP
/var/www/html/secret/wp-includes/Requests/Exception/HTTP.php
/var/www/html/secret/wp-includes/Requests/Exception/HTTP/304.php
/var/www/html/secret/wp-includes/Requests/Exception/HTTP/305.php
/var/www/html/secret/wp-includes/Requests/Exception/HTTP/306.php
/var/www/html/secret/wp-includes/Requests/Exception/HTTP/400.php
/var/www/html/secret/wp-includes/Requests/Exception/HTTP/401.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-includes/Requests/Exception/Transport
/var/www/html/secret/wp-includes/Requests/Exception/Transport.php
/var/www/html/secret/wp-includes/Requests/Exception/Transport/cURL.php
/var/www/html/secret/wp-includes/Requests/Hooker.php
/var/www/html/secret/wp-includes/Requests/Hooks.php
/var/www/html/secret/wp-includes/Requests/IDNAEncoder.php
/var/www/html/secret/wp-includes/Requests/IPv6.php
/var/www/html/secret/wp-includes/Requests/IRI.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-includes/Requests/Proxy/HTTP.php
/var/www/html/secret/wp-includes/Requests/Response
/var/www/html/secret/wp-includes/Requests/Response.php
/var/www/html/secret/wp-includes/Requests/Response/Headers.php
/var/www/html/secret/wp-includes/Requests/SSL.php
/var/www/html/secret/wp-includes/Requests/Session.php
/var/www/html/secret/wp-includes/Requests/Transport
/var/www/html/secret/wp-includes/Requests/Transport.php
/var/www/html/secret/wp-includes/Requests/Transport/cURL.php
/var/www/html/secret/wp-includes/Requests/Transport/fsockopen.php
/var/www/html/secret/wp-includes/Requests/Utility
/var/www/html/secret/wp-includes/Requests/Utility/CaseInsensitiveDictionary.php
/var/www/html/secret/wp-includes/Requests/Utility/FilteredIterator.php
/var/www/html/secret/wp-includes/SimplePie
/var/www/html/secret/wp-includes/SimplePie/Author.php
/var/www/html/secret/wp-includes/SimplePie/Cache
/var/www/html/secret/wp-includes/SimplePie/Cache.php
/var/www/html/secret/wp-includes/SimplePie/Cache/Base.php
/var/www/html/secret/wp-includes/SimplePie/Cache/DB.php
/var/www/html/secret/wp-includes/SimplePie/Cache/File.php
/var/www/html/secret/wp-includes/SimplePie/Cache/Memcache.php
/var/www/html/secret/wp-includes/SimplePie/Cache/MySQL.php
/var/www/html/secret/wp-includes/SimplePie/Caption.php
/var/www/html/secret/wp-includes/SimplePie/Category.php
/var/www/html/secret/wp-includes/SimplePie/Content
/var/www/html/secret/wp-includes/SimplePie/Content/Type
/var/www/html/secret/wp-includes/SimplePie/Content/Type/Sniffer.php
/var/www/html/secret/wp-includes/SimplePie/Copyright.php
/var/www/html/secret/wp-includes/SimplePie/Core.php
/var/www/html/secret/wp-includes/SimplePie/Credit.php
/var/www/html/secret/wp-includes/SimplePie/Decode
/var/www/html/secret/wp-includes/SimplePie/Decode/HTML
/var/www/html/secret/wp-includes/SimplePie/Decode/HTML/Entities.php
/var/www/html/secret/wp-includes/SimplePie/Enclosure.php
/var/www/html/secret/wp-includes/SimplePie/Exception.php
/var/www/html/secret/wp-includes/SimplePie/File.php
/var/www/html/secret/wp-includes/SimplePie/HTTP
/var/www/html/secret/wp-includes/SimplePie/HTTP/Parser.php
/var/www/html/secret/wp-includes/SimplePie/IRI.php
/var/www/html/secret/wp-includes/SimplePie/Item.php
/var/www/html/secret/wp-includes/SimplePie/Locator.php
/var/www/html/secret/wp-includes/SimplePie/Misc.php
/var/www/html/secret/wp-includes/SimplePie/Net
/var/www/html/secret/wp-includes/SimplePie/Net/IPv6.php
/var/www/html/secret/wp-includes/SimplePie/Parse
/var/www/html/secret/wp-includes/SimplePie/Parse/Date.php
/var/www/html/secret/wp-includes/SimplePie/Parser.php
/var/www/html/secret/wp-includes/SimplePie/Rating.php
/var/www/html/secret/wp-includes/SimplePie/Registry.php
/var/www/html/secret/wp-includes/SimplePie/Restriction.php
/var/www/html/secret/wp-includes/SimplePie/Sanitize.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-includes/SimplePie/XML/Declaration
/var/www/html/secret/wp-includes/SimplePie/XML/Declaration/Parser.php
/var/www/html/secret/wp-includes/SimplePie/gzdecode.php
/var/www/html/secret/wp-includes/Text
/var/www/html/secret/wp-includes/Text/Diff
/var/www/html/secret/wp-includes/Text/Diff.php
/var/www/html/secret/wp-includes/Text/Diff/Engine
/var/www/html/secret/wp-includes/Text/Diff/Engine/native.php
/var/www/html/secret/wp-includes/Text/Diff/Engine/shell.php
/var/www/html/secret/wp-includes/Text/Diff/Engine/string.php
/var/www/html/secret/wp-includes/Text/Diff/Engine/xdiff.php
/var/www/html/secret/wp-includes/Text/Diff/Renderer
/var/www/html/secret/wp-includes/Text/Diff/Renderer.php
/var/www/html/secret/wp-includes/Text/Diff/Renderer/inline.php
/var/www/html/secret/wp-includes/admin-bar.php
/var/www/html/secret/wp-includes/atomlib.php
/var/www/html/secret/wp-includes/author-template.php
/var/www/html/secret/wp-includes/bookmark-template.php
/var/www/html/secret/wp-includes/bookmark.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-includes/certificates/ca-bundle.crt
/var/www/html/secret/wp-includes/class-IXR.php
/var/www/html/secret/wp-includes/class-feed.php
/var/www/html/secret/wp-includes/class-http.php
/var/www/html/secret/wp-includes/class-json.php
/var/www/html/secret/wp-includes/class-oembed.php
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-includes/css/admin-bar-rtl.css
/var/www/html/secret/wp-includes/css/admin-bar-rtl.min.css
/var/www/html/secret/wp-includes/css/admin-bar.css
/var/www/html/secret/wp-includes/css/admin-bar.min.css
/var/www/html/secret/wp-includes/css/buttons-rtl.css
#)You_can_write_even_more_files_inside_last_directory

/var/www/html/secret/wp-includes/customize
/var/www/html/secret/wp-includes/customize/class-wp-customize-background-image-control.php
/var/www/html/secret/wp-includes/customize/class-wp-customize-background-image-setting.php
/var/www/html/secret/wp-includes/customize/class-wp-customize-background-position-control.php

╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files
  Group www-data:
/var/tmp/www
/var/tmp/www/li.sh
/var/tmp/www/lin-out.txt
/var/tmp/www/linpeas.sh
/var/tmp/www/li.txt

╔══════════╣ Searching passwords in history files

╔══════════╣ Searching passwords in config PHP files
	$pwd = trim( wp_unslash( $_POST[ 'pwd' ] ) );
	define('DB_PASSWORD', $pwd);
	define('DB_USER', $uname);
define('DB_PASSWORD', 'password_here');
define('DB_USER', 'username_here');
	$pwd = trim( wp_unslash( $_POST[ 'pwd' ] ) );
	define('DB_PASSWORD', $pwd);
	define('DB_USER', $uname);
define('DB_PASSWORD', 'arootmysqlpass');
define('DB_USER', 'root');

╔══════════╣ Searching *password* or *credential* files in home (limit 70)
/bin/systemd-ask-password
/bin/systemd-tty-ask-password-agent
/etc/brlapi.key
/etc/pam.d/common-password
/home/marlinspike/backdoored_proftpd-1.3.3c/contrib/mod_sftp/auth-password.c
/home/marlinspike/backdoored_proftpd-1.3.3c/tests/t/config/userpassword.t
/home/marlinspike/proftpd-1.3.3c/contrib/mod_sftp/auth-password.c
/home/marlinspike/proftpd-1.3.3c/tests/t/config/userpassword.t
/home/marlinspike/wordpress/wp-admin/js/password-strength-meter.js
/home/marlinspike/wordpress/wp-admin/js/password-strength-meter.min.js
/usr/bin/credentials-preferences
/usr/lib/evolution-data-server/credential-modules
/usr/lib/evolution-data-server/credential-modules/module-credentials-goa.so
/usr/lib/evolution-data-server/credential-modules/module-credentials-uoa.so
/usr/lib/grub/i386-pc/legacy_password_test.mod
/usr/lib/grub/i386-pc/password.mod
/usr/lib/grub/i386-pc/password_pbkdf2.mod
/usr/lib/libreoffice/program/libpasswordcontainerlo.so
/usr/lib/libreoffice/share/config/soffice.cfg/cui/ui/password.ui
/usr/lib/libreoffice/share/config/soffice.cfg/dbaccess/ui/password.ui
/usr/lib/libreoffice/share/config/soffice.cfg/modules/scalc/ui/retypepassworddialog.ui
/usr/lib/libreoffice/share/config/soffice.cfg/sfx/ui/password.ui
/usr/lib/libreoffice/share/config/soffice.cfg/uui/ui/masterpassworddlg.ui
/usr/lib/libreoffice/share/config/soffice.cfg/uui/ui/password.ui
/usr/lib/libreoffice/share/config/soffice.cfg/uui/ui/setmasterpassworddlg.ui
/usr/lib/libreoffice/share/config/soffice.cfg/vcl/ui/cupspassworddialog.ui
/usr/lib/mysql/plugin/validate_password.so
/usr/lib/pppd/2.4.7/passwordfd.so
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-35.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-35.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/usr/lib/x86_64-linux-gnu/libsamba-credentials.so.0
/usr/lib/x86_64-linux-gnu/libsamba-credentials.so.0.0.1
/usr/lib/x86_64-linux-gnu/samba/libcmdline-credentials.so.0
/usr/lib/x86_64-linux-gnu/signon/libpasswordplugin.so
/usr/lib/x86_64-linux-gnu/unity-control-center-1/panels/libcredentials.so
/usr/share/app-install/desktop/password-gorilla:password-gorilla.desktop
/usr/share/app-install/desktop/unity-control-center-signon:credentials-preferences.desktop
/usr/share/app-install/desktop/unity-control-center-signon:unity-credentials-panel.desktop
/usr/share/app-install/icons/credentials-preferences.png
/usr/share/app-install/icons/password-gorilla.png
/usr/share/app-install/icons/password.png
/usr/share/app-install/icons/preferences-desktop-user-password.svg
  #)There are more creds/passwds files in the previous parent folder

/usr/share/applications/unity-credentials-panel.desktop
/usr/share/dbus-1/services/com.canonical.indicators.webcredentials.service
/usr/share/dbus-1/services/com.canonical.webcredentials.capture.service
/usr/share/dns/root.key
/usr/share/doc/signon-plugin-password
/usr/share/help-langpack/en_AU/ubuntu-help/user-changepassword.page
/usr/share/help-langpack/en_AU/ubuntu-help/user-forgottenpassword.page
/usr/share/help-langpack/en_AU/ubuntu-help/user-goodpassword.page
/usr/share/help-langpack/en_CA/ubuntu-help/user-changepassword.page
/usr/share/help-langpack/en_CA/ubuntu-help/user-forgottenpassword.page
/usr/share/help-langpack/en_CA/ubuntu-help/user-goodpassword.page
/usr/share/help-langpack/en_GB/evince/password.page
/usr/share/help-langpack/en_GB/ubuntu-help/user-changepassword.page
/usr/share/help-langpack/en_GB/ubuntu-help/user-forgottenpassword.page
/usr/share/help-langpack/en_GB/ubuntu-help/user-goodpassword.page
/usr/share/help-langpack/en_GB/zenity/password.page
/usr/share/help/C/evince/password.page
/usr/share/help/C/file-roller/password-protection.page
/usr/share/help/C/file-roller/troubleshooting-password.page
/usr/share/help/C/gnome-help/user-changepassword.page
/usr/share/help/C/gnome-help/user-goodpassword.page
/usr/share/help/C/onboard/password-dialogs.page
/usr/share/help/C/seahorse/keyring-update-password.page
/usr/share/help/C/seahorse/passwords-stored-create.page

╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs

╔══════════╣ Searching passwords inside logs (limit 70)
 base-passwd depends on libc6 (>= 2.8); however:
 base-passwd depends on libdebconfclient0 (>= 0.145); however:
2017-08-01 11:17:45 configure base-passwd:amd64 3.5.39 3.5.39
2017-08-01 11:17:45 install base-passwd:amd64 <none> 3.5.39
2017-08-01 11:17:45 status half-configured base-passwd:amd64 3.5.39
2017-08-01 11:17:45 status half-installed base-passwd:amd64 3.5.39
2017-08-01 11:17:45 status unpacked base-passwd:amd64 3.5.39
2017-08-01 11:17:46 status installed base-passwd:amd64 3.5.39
2017-08-01 11:17:49 status half-configured base-passwd:amd64 3.5.39
2017-08-01 11:17:49 status half-installed base-passwd:amd64 3.5.39
2017-08-01 11:17:49 status unpacked base-passwd:amd64 3.5.39
2017-08-01 11:17:49 upgrade base-passwd:amd64 3.5.39 3.5.39
2017-08-01 11:17:57 install passwd:amd64 <none> 1:4.2-3.1ubuntu5
2017-08-01 11:17:57 status half-installed passwd:amd64 1:4.2-3.1ubuntu5
2017-08-01 11:17:57 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
2017-08-01 11:18:01 configure base-passwd:amd64 3.5.39 <none>
2017-08-01 11:18:01 status half-configured base-passwd:amd64 3.5.39
2017-08-01 11:18:01 status installed base-passwd:amd64 3.5.39
2017-08-01 11:18:01 status unpacked base-passwd:amd64 3.5.39
2017-08-01 11:18:09 configure passwd:amd64 1:4.2-3.1ubuntu5 <none>
2017-08-01 11:18:09 status half-configured passwd:amd64 1:4.2-3.1ubuntu5
2017-08-01 11:18:09 status installed passwd:amd64 1:4.2-3.1ubuntu5
2017-08-01 11:18:09 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
2017-08-01 11:19:01 configure passwd:amd64 1:4.2-3.1ubuntu5.3 <none>
2017-08-01 11:19:01 status half-configured passwd:amd64 1:4.2-3.1ubuntu5
2017-08-01 11:19:01 status half-configured passwd:amd64 1:4.2-3.1ubuntu5.3
2017-08-01 11:19:01 status half-installed passwd:amd64 1:4.2-3.1ubuntu5
2017-08-01 11:19:01 status installed passwd:amd64 1:4.2-3.1ubuntu5.3
2017-08-01 11:19:01 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
2017-08-01 11:19:01 status unpacked passwd:amd64 1:4.2-3.1ubuntu5.3
2017-08-01 11:19:01 upgrade passwd:amd64 1:4.2-3.1ubuntu5 1:4.2-3.1ubuntu5.3
2017-08-01 11:24:05 install signon-plugin-password:amd64 <none> 8.58+16.04.20151106-0ubuntu1
2017-08-01 11:24:05 status half-installed signon-plugin-password:amd64 8.58+16.04.20151106-0ubuntu1
2017-08-01 11:24:05 status unpacked signon-plugin-password:amd64 8.58+16.04.20151106-0ubuntu1
2017-08-01 11:28:31 configure signon-plugin-password:amd64 8.58+16.04.20151106-0ubuntu1 <none>
2017-08-01 11:28:31 status half-configured signon-plugin-password:amd64 8.58+16.04.20151106-0ubuntu1
2017-08-01 11:28:31 status installed signon-plugin-password:amd64 8.58+16.04.20151106-0ubuntu1
2017-08-01 11:28:31 status unpacked signon-plugin-password:amd64 8.58+16.04.20151106-0ubuntu1
Preparing to unpack .../base-passwd_3.5.39_amd64.deb ...
Preparing to unpack .../passwd_1%3a4.2-3.1ubuntu5_amd64.deb ...
Selecting previously unselected package base-passwd.
Selecting previously unselected package passwd.
Setting up base-passwd (3.5.39) ...
Setting up passwd (1:4.2-3.1ubuntu5) ...
Shadow passwords are now on.
Unpacking base-passwd (3.5.39) ...
Unpacking base-passwd (3.5.39) over (3.5.39) ...
Unpacking passwd (1:4.2-3.1ubuntu5) ...
dpkg: base-passwd: dependency problems, but configuring anyway as you requested:

